"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[494],{494:(_n,R,c)=>{c.r(R),c.d(R,{AccessModule:()=>un});var _=c(9808),k=c(4521),A=c(552),O=c(647),h=c(5617),T=c(5650),p=c(7910),e=c(5e3),g=c(7957),N=c(822),J=c(520);let E=(()=>{class i extends N.b{constructor(t){super(t,"/access/permissions"),this._httpClient=t,this.server.urls.member="/appsInRole",this.server.urls.memberOut="/appsNotInRole"}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(J.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var l=c(2382),q=c(9727),v=c(7484),u=c(4546),f=c(1894),y=c(1047),Z=c(6042),b=c(2643),C=c(2683),a=c(592);function W(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.text.add")," "))}function ee(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.none")))}function te(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1011")))}function ne(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1012")))}function ie(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1013")))}function re(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1014")))}function oe(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1015")))}function se(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1016")))}function ae(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1017")))}function le(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1111")))}function de(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1112")))}function me(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1113")))}function ce(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1114")))}function ue(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1211")))}function pe(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1212")))}function _e(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1213")))}function he(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1214")))}function ge(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1215")))}function fe(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1311")))}function ze(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1411")))}function ye(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1511")))}function xe(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1512")))}function qe(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1611")))}function Ze(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1711")))}function be(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1712")))}function Ce(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1811")))}function Te(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1812")))}function ke(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1911")))}function Ae(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1912")))}function ve(i,s){1&i&&e._UZ(0,"i",24)}function Se(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",19),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.id,r)}),e.qZA(),e.TgZ(2,"td",16),e._UZ(3,"img",20),e.qZA(),e.TgZ(4,"td",21),e._uU(5),e.qZA(),e.TgZ(6,"td",21),e.YNc(7,ee,3,3,"div",22),e.YNc(8,te,3,3,"div",22),e.YNc(9,ne,3,3,"div",22),e.YNc(10,ie,3,3,"div",22),e.YNc(11,re,3,3,"div",22),e.YNc(12,oe,3,3,"div",22),e.YNc(13,se,3,3,"div",22),e.YNc(14,ae,3,3,"div",22),e.YNc(15,le,3,3,"div",22),e.YNc(16,de,3,3,"div",22),e.YNc(17,me,3,3,"div",22),e.YNc(18,ce,3,3,"div",22),e.YNc(19,ue,3,3,"div",22),e.YNc(20,pe,3,3,"div",22),e.YNc(21,_e,3,3,"div",22),e.YNc(22,he,3,3,"div",22),e.YNc(23,ge,3,3,"div",22),e.YNc(24,fe,3,3,"div",22),e.YNc(25,ze,3,3,"div",22),e.YNc(26,ye,3,3,"div",22),e.YNc(27,xe,3,3,"div",22),e.YNc(28,qe,3,3,"div",22),e.YNc(29,Ze,3,3,"div",22),e.YNc(30,be,3,3,"div",22),e.YNc(31,Ce,3,3,"div",22),e.YNc(32,Te,3,3,"div",22),e.YNc(33,ke,3,3,"div",22),e.YNc(34,Ae,3,3,"div",22),e.qZA(),e.TgZ(35,"td",21),e._uU(36),e.qZA(),e.TgZ(37,"td",16),e.YNc(38,ve,1,0,"i",23),e.qZA()()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(2),e.s9C("src",t.iconBase64,e.LSH),e.xp6(2),e.hij(" ",t.appName,""),e.xp6(2),e.Q6J("ngIf","none"==t.category),e.xp6(1),e.Q6J("ngIf","1011"==t.category),e.xp6(1),e.Q6J("ngIf","1012"==t.category),e.xp6(1),e.Q6J("ngIf","1013"==t.category),e.xp6(1),e.Q6J("ngIf","1014"==t.category),e.xp6(1),e.Q6J("ngIf","1015"==t.category),e.xp6(1),e.Q6J("ngIf","1016"==t.category),e.xp6(1),e.Q6J("ngIf","1017"==t.category),e.xp6(1),e.Q6J("ngIf","1111"==t.category),e.xp6(1),e.Q6J("ngIf","1112"==t.category),e.xp6(1),e.Q6J("ngIf","1113"==t.category),e.xp6(1),e.Q6J("ngIf","1114"==t.category),e.xp6(1),e.Q6J("ngIf","1211"==t.category),e.xp6(1),e.Q6J("ngIf","1212"==t.category),e.xp6(1),e.Q6J("ngIf","1213"==t.category),e.xp6(1),e.Q6J("ngIf","1214"==t.category),e.xp6(1),e.Q6J("ngIf","1215"==t.category),e.xp6(1),e.Q6J("ngIf","1311"==t.category),e.xp6(1),e.Q6J("ngIf","1411"==t.category),e.xp6(1),e.Q6J("ngIf","1511"==t.category),e.xp6(1),e.Q6J("ngIf","1512"==t.category),e.xp6(1),e.Q6J("ngIf","1611"==t.category),e.xp6(1),e.Q6J("ngIf","1711"==t.category),e.xp6(1),e.Q6J("ngIf","1712"==t.category),e.xp6(1),e.Q6J("ngIf","1811"==t.category),e.xp6(1),e.Q6J("ngIf","1812"==t.category),e.xp6(1),e.Q6J("ngIf","1911"==t.category),e.xp6(1),e.Q6J("ngIf","1912"==t.category),e.xp6(2),e.hij(" ",t.sortIndex,""),e.xp6(2),e.Q6J("ngIf",1==t.status)}}function Me(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",25)(1,"button",26),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onClose(r)}),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"button",11),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onSubmit(r)}),e._uU(5),e.ALo(6,"i18n"),e.qZA()()}2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"mxk.text.close")),e.xp6(3),e.Oqu(e.lcZ(6,4,"mxk.text.submit")))}c(7758);const Oe=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}},Le=function(){return{standalone:!0}};let w=(()=>{class i{constructor(t,n,r,o,m,d,z){this.modalRef=t,this.rolePermissionsService=n,this.viewContainerRef=r,this.fb=o,this.msg=m,this.i18n=d,this.cdr=z,this.query={params:{appName:"",displayName:"",username:"",roleId:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:5,pageNumber:1,pageSizeOptions:[5,15,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.roleId&&(this.query.params.roleId=this.roleId,this.fetch())}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.fetch()}onSearch(){this.fetch()}onReset(){}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.rolePermissionsService.memberOut(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}onSubmit(t){t.preventDefault();let r=this.query.results.rows.filter(({disabled:d})=>!d).filter(({id:d})=>this.query.tableCheckedId.has(d)),o="",m="";for(let d=0;d<r.length;d++)o=`${o},${r[d].id}`,m=`${m},${r[d].username}`;this.rolePermissionsService.add({roleId:this.roleId,appId:o,appName:m}).subscribe(d=>{this.query.results=d.data,this.query.submitLoading=!1,this.query.tableLoading=!1,0==d.code?(this.msg.success(this.i18n.fanyi("mxk.alert.add.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.add.error")),this.cdr.detectChanges()})}onClose(t){t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Lf),e.Y36(E),e.Y36(e.s_b),e.Y36(l.qu),e.Y36(q.dD),e.Y36(h.Oi),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-permissions-editer"]],inputs:{roleId:"roleId",isEdit:"isEdit"},decls:50,vars:54,consts:[[4,"nzModalTitle"],[3,"nzBordered"],["nz-form","",1,"search__form",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","14","nzSm","24"],["nzFor","appName"],["nz-input","","name","appName","placeholder","","id","appName",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",2,"display","none",3,"click"],["nz-button","",1,"mx-sm",2,"display","none",3,"click"],["nz-button","","nzType","primary",3,"click"],["nzTableLayout","auto","nzBordered","","nzShowSizeChanger","","nzWidth","100%",3,"nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzAlign","center",2,"display","none"],["nzAlign","center"],[4,"ngFor","ngForOf"],["style","display: none",4,"nzModalFooter"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["height","30","border","0px",3,"src"],["nzAlign","left"],[4,"ngIf"],["nz-icon","","nzType","check-circle","nzTheme","fill","style","color: green",4,"ngIf"],["nz-icon","","nzType","check-circle","nzTheme","fill",2,"color","green"],[2,"display","none"],["nz-button","","nzType","default",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,W,3,3,"div",0),e.TgZ(1,"nz-card",1)(2,"form",2),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(3,"div",3)(4,"div",4)(5,"nz-form-item")(6,"nz-form-label",5),e._uU(7),e.ALo(8,"i18n"),e.qZA(),e.TgZ(9,"nz-form-control")(10,"input",6),e.NdJ("ngModelChange",function(o){return n.query.params.appName=o}),e.qZA()()()(),e.TgZ(11,"div",7)(12,"button",8),e._uU(13),e.ALo(14,"i18n"),e.qZA(),e.TgZ(15,"button",9),e.NdJ("click",function(){return n.onReset()}),e._uU(16),e.ALo(17,"i18n"),e.qZA(),e.TgZ(18,"button",10),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(19),e.ALo(20,"i18n"),e.ALo(21,"i18n"),e.qZA(),e.TgZ(22,"button",11),e.NdJ("click",function(o){return n.onSubmit(o)}),e._uU(23),e.ALo(24,"i18n"),e.qZA()()()(),e.TgZ(25,"nz-table",12,13),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(27,"thead")(28,"tr")(29,"th",14),e.NdJ("nzCheckedChange",function(o){return n.onTableAllChecked(o)}),e.qZA(),e.TgZ(30,"th",15),e._uU(31,"Id"),e.qZA(),e.TgZ(32,"th",16),e._uU(33),e.ALo(34,"i18n"),e.qZA(),e.TgZ(35,"th",16),e._uU(36),e.ALo(37,"i18n"),e.qZA(),e.TgZ(38,"th",16),e._uU(39),e.ALo(40,"i18n"),e.qZA(),e.TgZ(41,"th",16),e._uU(42),e.ALo(43,"i18n"),e.qZA(),e.TgZ(44,"th",16),e._uU(45),e.ALo(46,"i18n"),e.qZA()()(),e.TgZ(47,"tbody"),e.YNc(48,Se,39,34,"tr",17),e.qZA()()(),e.YNc(49,Me,7,6,"div",18)),2&t&&(e.xp6(1),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(52,Oe)),e.xp6(4),e.Oqu(e.lcZ(8,30,"mxk.apps.name")),e.xp6(3),e.Q6J("ngModel",n.query.params.appName)("ngModelOptions",e.DdM(53,Le)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:10),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(14,32,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(17,34,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(20,36,"mxk.text.collapse"):e.lcZ(21,38,"mxk.text.expand"),""),e.xp6(4),e.Oqu(e.lcZ(24,40,"mxk.text.confirm")),e.xp6(2),e.Q6J("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(4),e.Q6J("nzChecked",n.query.checked)("nzIndeterminate",n.query.indeterminate),e.xp6(4),e.Oqu(e.lcZ(34,42,"mxk.apps.icon")),e.xp6(3),e.Oqu(e.lcZ(37,44,"mxk.apps.name")),e.xp6(3),e.Oqu(e.lcZ(40,46,"mxk.apps.category")),e.xp6(3),e.Oqu(e.lcZ(43,48,"mxk.text.sortIndex")),e.xp6(3),e.Oqu(e.lcZ(46,50,"mxk.text.status")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows))},directives:[g.h1,v.bd,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,y.Zp,l.Fj,l.JJ,l.On,Z.ix,b.dQ,C.w,a.N8,a.Om,a.$Z,a.Uo,a._C,a.g6,a.UX,a.p0,_.sg,a.h7,_.O5,O.Ls,g.Uh],pipes:[h.Ck],styles:[""]}),i})();var I=c(8432);function Ne(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.text.select")," "))}function Je(i,s){1&i&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.dynamic"),""))}function Ie(i,s){1&i&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.static"),""))}function Pe(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",17),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.id,r)}),e.qZA(),e.TgZ(2,"td",18)(3,"span"),e._uU(4),e.qZA()(),e.TgZ(5,"td",19),e._uU(6),e.qZA(),e.YNc(7,Je,3,3,"td",20),e.YNc(8,Ie,3,3,"td",20),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(3),e.Oqu(t.id),e.xp6(2),e.hij(" ",t.roleName,""),e.xp6(1),e.Q6J("ngIf","dynamic"==t.category),e.xp6(1),e.Q6J("ngIf","static"==t.category)}}function Ue(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",21)(1,"button",22),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onClose(r)}),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"button",10),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onSubmit(r)}),e._uU(5),e.ALo(6,"i18n"),e.qZA()()}2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"mxk.text.close")),e.xp6(3),e.Oqu(e.lcZ(6,4,"mxk.text.submit")))}const De=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}},Qe=function(){return{standalone:!0}};let P=(()=>{class i{constructor(t,n,r,o,m,d){this.modalRef=t,this.rolesService=n,this.viewContainerRef=r,this.fb=o,this.msg=m,this.cdr=d,this.query={params:{roleName:"",displayName:"",protocol:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:5,pageNumber:1,pageSizeOptions:[5,15,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.fetch()}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.fetch()}onSearch(){this.fetch()}onReset(){}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.rolesService.fetch(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.onTableAllChecked(!1),this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}onSubmit(t){t.preventDefault();let r=this.query.results.rows.filter(({disabled:o})=>!o).filter(({id:o})=>this.query.tableCheckedId.has(o));this.modalRef.destroy({refresh:!0,data:r[0]})}onClose(t){t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Lf),e.Y36(I.f),e.Y36(e.s_b),e.Y36(l.qu),e.Y36(q.dD),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-select-roles"]],decls:40,vars:42,consts:[[4,"nzModalTitle"],["nz-form","",1,"search__form",2,"margin-bottom","10px",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","14","nzSm","24"],["nzFor","roleName"],["nz-input","","name","roleName","placeholder","","id","roleName",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",2,"display","none",3,"click"],["nz-button","",1,"mx-sm",2,"display","none",3,"click"],["nz-button","","nzType","primary",3,"click"],["nzTableLayout","auto","nzSize","small","nzBordered","","nzShowSizeChanger","","nzWidth","100%",3,"nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],["nzAlign","center",2,"display","none"],["nzAlign","center"],[4,"ngFor","ngForOf"],["style","display: none",4,"nzModalFooter"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left",2,"display","none"],["nzAlign","left"],["nzAlign","center",4,"ngIf"],[2,"display","none"],["nz-button","","nzType","default",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,Ne,3,3,"div",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(2,"div",2)(3,"div",3)(4,"nz-form-item")(5,"nz-form-label",4),e._uU(6),e.ALo(7,"i18n"),e.qZA(),e.TgZ(8,"nz-form-control")(9,"input",5),e.NdJ("ngModelChange",function(o){return n.query.params.roleName=o}),e.qZA()()()(),e.TgZ(10,"div",6)(11,"button",7),e._uU(12),e.ALo(13,"i18n"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return n.onReset()}),e._uU(15),e.ALo(16,"i18n"),e.qZA(),e.TgZ(17,"button",9),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(18),e.ALo(19,"i18n"),e.ALo(20,"i18n"),e.qZA(),e.TgZ(21,"button",10),e.NdJ("click",function(o){return n.onSubmit(o)}),e._uU(22),e.ALo(23,"i18n"),e.qZA()()()(),e.TgZ(24,"nz-table",11,12),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(26,"thead")(27,"tr"),e._UZ(28,"th"),e.TgZ(29,"th",13),e._uU(30,"Id"),e.qZA(),e.TgZ(31,"th",14),e._uU(32),e.ALo(33,"i18n"),e.qZA(),e.TgZ(34,"th",14),e._uU(35),e.ALo(36,"i18n"),e.qZA()()(),e.TgZ(37,"tbody"),e.YNc(38,Pe,9,6,"tr",15),e.qZA()(),e.YNc(39,Ue,7,6,"div",16)),2&t&&(e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(40,De)),e.xp6(4),e.Oqu(e.lcZ(7,24,"mxk.roles.name")),e.xp6(3),e.Q6J("ngModel",n.query.params.roleName)("ngModelOptions",e.DdM(41,Qe)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:10),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(13,26,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(16,28,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(19,30,"mxk.text.collapse"):e.lcZ(20,32,"mxk.text.expand"),""),e.xp6(4),e.Oqu(e.lcZ(23,34,"mxk.text.confirm")),e.xp6(2),e.Q6J("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(8),e.Oqu(e.lcZ(33,36,"mxk.roles.name")),e.xp6(3),e.Oqu(e.lcZ(36,38,"mxk.roles.category")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows))},directives:[g.h1,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,y.Zp,l.Fj,l.JJ,l.On,Z.ix,b.dQ,C.w,a.N8,a.Om,a.$Z,a.Uo,a._C,a.UX,a.p0,_.sg,a.h7,_.O5,g.Uh],pipes:[h.Ck],styles:[""]}),i})();var L=c(7946);function Fe(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",25),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onSelect(r)}),e._uU(1),e.ALo(2,"i18n"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.text.select")))}function Re(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.none")))}function Ee(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1011")))}function we(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1012")))}function Ye(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1013")))}function He(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1014")))}function je(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1015")))}function $e(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1016")))}function Be(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1017")))}function Xe(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1111")))}function Ge(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1112")))}function Ke(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1113")))}function Ve(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1114")))}function We(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1211")))}function et(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1212")))}function tt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1213")))}function nt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1214")))}function it(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1215")))}function rt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1311")))}function ot(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1411")))}function st(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1511")))}function at(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1512")))}function lt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1611")))}function dt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1711")))}function mt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1712")))}function ct(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1811")))}function ut(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1812")))}function pt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1911")))}function _t(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.apps.category.1912")))}function ht(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",26),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.id,r)}),e.qZA(),e.TgZ(2,"td",27),e._uU(3),e.qZA(),e.TgZ(4,"td",22),e._UZ(5,"img",28),e.qZA(),e.TgZ(6,"td",27),e._uU(7),e.qZA(),e.TgZ(8,"td",27),e.YNc(9,Re,3,3,"div",29),e.YNc(10,Ee,3,3,"div",29),e.YNc(11,we,3,3,"div",29),e.YNc(12,Ye,3,3,"div",29),e.YNc(13,He,3,3,"div",29),e.YNc(14,je,3,3,"div",29),e.YNc(15,$e,3,3,"div",29),e.YNc(16,Be,3,3,"div",29),e.YNc(17,Xe,3,3,"div",29),e.YNc(18,Ge,3,3,"div",29),e.YNc(19,Ke,3,3,"div",29),e.YNc(20,Ve,3,3,"div",29),e.YNc(21,We,3,3,"div",29),e.YNc(22,et,3,3,"div",29),e.YNc(23,tt,3,3,"div",29),e.YNc(24,nt,3,3,"div",29),e.YNc(25,it,3,3,"div",29),e.YNc(26,rt,3,3,"div",29),e.YNc(27,ot,3,3,"div",29),e.YNc(28,st,3,3,"div",29),e.YNc(29,at,3,3,"div",29),e.YNc(30,lt,3,3,"div",29),e.YNc(31,dt,3,3,"div",29),e.YNc(32,mt,3,3,"div",29),e.YNc(33,ct,3,3,"div",29),e.YNc(34,ut,3,3,"div",29),e.YNc(35,pt,3,3,"div",29),e.YNc(36,_t,3,3,"div",29),e.qZA(),e.TgZ(37,"td",30)(38,"div",31)(39,"button",32),e.NdJ("click",function(r){const m=e.CHM(t).$implicit;return e.oxw().onDelete(r,m.id)}),e._uU(40),e.ALo(41,"i18n"),e.qZA()()()()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(2),e.hij(" ",t.roleName,""),e.xp6(2),e.s9C("src",t.iconBase64,e.LSH),e.xp6(2),e.hij(" ",t.appName,""),e.xp6(2),e.Q6J("ngIf","none"==t.category),e.xp6(1),e.Q6J("ngIf","1011"==t.category),e.xp6(1),e.Q6J("ngIf","1012"==t.category),e.xp6(1),e.Q6J("ngIf","1013"==t.category),e.xp6(1),e.Q6J("ngIf","1014"==t.category),e.xp6(1),e.Q6J("ngIf","1015"==t.category),e.xp6(1),e.Q6J("ngIf","1016"==t.category),e.xp6(1),e.Q6J("ngIf","1017"==t.category),e.xp6(1),e.Q6J("ngIf","1111"==t.category),e.xp6(1),e.Q6J("ngIf","1112"==t.category),e.xp6(1),e.Q6J("ngIf","1113"==t.category),e.xp6(1),e.Q6J("ngIf","1114"==t.category),e.xp6(1),e.Q6J("ngIf","1211"==t.category),e.xp6(1),e.Q6J("ngIf","1212"==t.category),e.xp6(1),e.Q6J("ngIf","1213"==t.category),e.xp6(1),e.Q6J("ngIf","1214"==t.category),e.xp6(1),e.Q6J("ngIf","1215"==t.category),e.xp6(1),e.Q6J("ngIf","1311"==t.category),e.xp6(1),e.Q6J("ngIf","1411"==t.category),e.xp6(1),e.Q6J("ngIf","1511"==t.category),e.xp6(1),e.Q6J("ngIf","1512"==t.category),e.xp6(1),e.Q6J("ngIf","1611"==t.category),e.xp6(1),e.Q6J("ngIf","1711"==t.category),e.xp6(1),e.Q6J("ngIf","1712"==t.category),e.xp6(1),e.Q6J("ngIf","1811"==t.category),e.xp6(1),e.Q6J("ngIf","1812"==t.category),e.xp6(1),e.Q6J("ngIf","1911"==t.category),e.xp6(1),e.Q6J("ngIf","1912"==t.category),e.xp6(4),e.Oqu(e.lcZ(41,34,"mxk.text.delete"))}}const gt=function(){return{xs:8,sm:8,md:24,lg:24,xl:48,xxl:48}},Y=function(){return{standalone:!0}},ft=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}};let H=(()=>{class i{constructor(t,n,r,o,m,d,z,M,pn){this.modalService=t,this.rolePermissionsService=n,this.viewContainerRef=r,this.fb=o,this.msg=m,this.i18n=d,this.route=z,this.cdr=M,this.http=pn,this.query={params:{displayName:"",username:"",roleId:"",roleName:"",appName:"",appId:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:10,pageNumber:1,pageSizeOptions:[10,20,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableInitialize:!0,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.route.snapshot.queryParams.roleId&&(this.query.params.roleId=this.route.snapshot.queryParams.roleId,this.query.params.roleName=this.route.snapshot.queryParams.roleName),this.query.tableInitialize=!1}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.query.tableInitialize||this.fetch()}onSearch(){this.fetch()}onReset(){}onBatchDelete(t){t.preventDefault(),this.rolePermissionsService.delete((0,A.$$)(this.query.tableCheckedId)).subscribe(n=>{0==n.code?(this.msg.success(this.i18n.fanyi("mxk.alert.delete.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.delete.error")),this.cdr.detectChanges()})}onAdd(t){t.preventDefault(),this.modalService.create({nzContent:w,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{isEdit:!1,roleId:this.query.params.roleId},nzWidth:700,nzOnOk:()=>new Promise(r=>setTimeout(r,1e3))}).afterClose.subscribe(r=>{r.refresh&&this.fetch()})}onSelect(t){t.preventDefault(),this.modalService.create({nzContent:P,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{},nzWidth:700,nzOnOk:()=>new Promise(r=>setTimeout(r,1e3))}).afterClose.subscribe(r=>{r.refresh&&(this.query.params.roleName=r.data.roleName,this.query.params.roleId=r.data.id,console.log(r),this.fetch())})}onDelete(t,n){t.preventDefault(),this.rolePermissionsService.delete(n).subscribe(r=>{0==r.code?(this.msg.success(this.i18n.fanyi("mxk.alert.delete.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.delete.error")),this.cdr.detectChanges()})}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.rolePermissionsService.member(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,console.log(t.data),this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Sf),e.Y36(E),e.Y36(e.s_b),e.Y36(l.qu),e.Y36(q.dD),e.Y36(h.Oi),e.Y36(k.gz),e.Y36(e.sBO),e.Y36(h.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-permissions"]],decls:66,vars:70,consts:[[3,"nzBordered"],["nz-form","",1,"search__form",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","10","nzSm","24"],["nzFor","roleName"],["nzSearch","",3,"nzAddOnAfter"],["nz-input","","name","roleName","readonly","","placeholder","","id","roleName",3,"ngModel","ngModelOptions","ngModelChange"],["suffixButton",""],["nzFor","name"],["nz-input","","name","appName","placeholder","","id","appName",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",2,"display","none",3,"click"],["nz-button","",1,"mx-sm",2,"display","none",3,"click"],["nz-col","",1,"table-list-toolbar",3,"nzSpan"],["nz-button","","type","button",3,"nzType","click"],["nz-button","","type","button","nzDanger","",1,"mx-sm",3,"nzType","click"],["nz-col","","nzMd","24","nzSm","24"],["nzTableLayout","auto","nzSize","small","nzBordered","","nzShowSizeChanger","",3,"nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzAlign","center",2,"display","none"],["nzAlign","center"],["nzAlign","center",1,"table_cell_action_1"],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary","nzSearch","",3,"click"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left"],["height","30","border","0px",3,"src"],[4,"ngIf"],["nzAlign","center","nzBreakWord","false"],["nz-col",""],["nz-button","","type","button","nzDanger","",3,"click"]],template:function(t,n){if(1&t&&(e._UZ(0,"page-header"),e.TgZ(1,"nz-card",0)(2,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(3,"div",2)(4,"div",3)(5,"nz-form-item")(6,"nz-form-label",4),e._uU(7),e.ALo(8,"i18n"),e.qZA(),e.TgZ(9,"nz-form-control")(10,"nz-input-group",5)(11,"input",6),e.NdJ("ngModelChange",function(o){return n.query.params.roleName=o}),e.qZA()(),e.YNc(12,Fe,3,3,"ng-template",null,7,e.W1O),e.qZA()()(),e.TgZ(14,"div",3)(15,"nz-form-item")(16,"nz-form-label",8),e._uU(17),e.ALo(18,"i18n"),e.qZA(),e.TgZ(19,"nz-form-control")(20,"input",9),e.NdJ("ngModelChange",function(o){return n.query.params.appName=o}),e.qZA()()()(),e.TgZ(21,"div",10)(22,"button",11),e._uU(23),e.ALo(24,"i18n"),e.qZA(),e.TgZ(25,"button",12),e.NdJ("click",function(){return n.onReset()}),e._uU(26),e.ALo(27,"i18n"),e.qZA(),e.TgZ(28,"button",13),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(29),e.ALo(30,"i18n"),e.ALo(31,"i18n"),e.qZA()()()()(),e.TgZ(32,"nz-card",0)(33,"div",2)(34,"div",14)(35,"button",15),e.NdJ("click",function(o){return n.onAdd(o)}),e._uU(36),e.ALo(37,"i18n"),e.qZA(),e.TgZ(38,"button",16),e.NdJ("click",function(o){return n.onBatchDelete(o)}),e._uU(39),e.ALo(40,"i18n"),e.qZA()(),e.TgZ(41,"div",17)(42,"nz-table",18,19),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(44,"thead")(45,"tr")(46,"th",20),e.NdJ("nzCheckedChange",function(o){return n.onTableAllChecked(o)}),e.qZA(),e.TgZ(47,"th",21),e._uU(48,"Id"),e.qZA(),e.TgZ(49,"th",22),e._uU(50),e.ALo(51,"i18n"),e.qZA(),e.TgZ(52,"th",22),e._uU(53),e.ALo(54,"i18n"),e.qZA(),e.TgZ(55,"th",22),e._uU(56),e.ALo(57,"i18n"),e.qZA(),e.TgZ(58,"th",22),e._uU(59),e.ALo(60,"i18n"),e.qZA(),e.TgZ(61,"th",23),e._uU(62),e.ALo(63,"i18n"),e.qZA()()(),e.TgZ(64,"tbody"),e.YNc(65,ht,42,36,"tr",24),e.qZA()()()()()),2&t){const r=e.MAs(13);e.xp6(1),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(66,gt)),e.xp6(4),e.Oqu(e.lcZ(8,40,"mxk.roles.name")),e.xp6(3),e.Q6J("nzAddOnAfter",r),e.xp6(1),e.Q6J("ngModel",n.query.params.roleName)("ngModelOptions",e.DdM(67,Y)),e.xp6(6),e.Oqu(e.lcZ(18,42,"mxk.apps.name")),e.xp6(3),e.Q6J("ngModel",n.query.params.appName)("ngModelOptions",e.DdM(68,Y)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:4),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(24,44,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(27,46,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(30,48,"mxk.text.collapse"):e.lcZ(31,50,"mxk.text.expand"),""),e.xp6(3),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzGutter",e.DdM(69,ft)),e.xp6(1),e.Q6J("nzSpan",24),e.xp6(1),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(37,52,"mxk.text.add")),e.xp6(2),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(40,54,"mxk.text.delete")),e.xp6(3),e.Q6J("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(4),e.Q6J("nzChecked",n.query.checked)("nzIndeterminate",n.query.indeterminate),e.xp6(4),e.Oqu(e.lcZ(51,56,"mxk.roles.name")),e.xp6(3),e.Oqu(e.lcZ(54,58,"mxk.apps.icon")),e.xp6(3),e.Oqu(e.lcZ(57,60,"mxk.apps.name")),e.xp6(3),e.Oqu(e.lcZ(60,62,"mxk.apps.category")),e.xp6(3),e.Oqu(e.lcZ(63,64,"mxk.text.action")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows)}},directives:[L.q,v.bd,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,C.w,y.gB,y.Zp,l.Fj,l.JJ,l.On,Z.ix,b.dQ,a.N8,a.Om,a.$Z,a.Uo,a._C,a.g6,a.UX,a.p0,_.sg,a.h7,_.O5,a.bF],pipes:[h.Ck],styles:[""]}),i})(),U=(()=>{class i extends N.b{constructor(t){super(t,"/access/rolemembers"),this._httpClient=t,this.server.urls.member="/memberInRole",this.server.urls.memberOut="/memberNotInRole"}rolesNoMember(t){return this.http.get(`${this.server.urls.base}/rolesNoMember`,{params:this.parseParams(t)})}addMember2Roles(t){return this.http.post(`${this.server.urls.base}/addMember2Roles`,t)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(J.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function zt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.text.add")," "))}function yt(i,s){1&i&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.dynamic"),""))}function xt(i,s){1&i&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.static"),""))}function qt(i,s){1&i&&(e.TgZ(0,"td",14),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.app"),""))}function Zt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",17),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.id,r)}),e.qZA(),e.TgZ(2,"td",18)(3,"span"),e._uU(4),e.qZA()(),e.TgZ(5,"td",19),e._uU(6),e.qZA(),e.YNc(7,yt,3,3,"td",20),e.YNc(8,xt,3,3,"td",20),e.YNc(9,qt,3,3,"td",20),e.qZA()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(3),e.Oqu(t.id),e.xp6(2),e.hij(" ",t.roleName,""),e.xp6(1),e.Q6J("ngIf","dynamic"==t.category),e.xp6(1),e.Q6J("ngIf","static"==t.category),e.xp6(1),e.Q6J("ngIf","app"==t.category)}}function bt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",21)(1,"button",22),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onClose(r)}),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"button",10),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onSubmit(r)}),e._uU(5),e.ALo(6,"i18n"),e.qZA()()}2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"mxk.text.close")),e.xp6(3),e.Oqu(e.lcZ(6,4,"mxk.text.submit")))}const Ct=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}},Tt=function(){return{standalone:!0}};let j=(()=>{class i{constructor(t,n,r,o,m,d,z){this.modalRef=t,this.roleMembersService=n,this.viewContainerRef=r,this.fb=o,this.msg=m,this.i18n=d,this.cdr=z,this.query={params:{roleName:"",username:"",protocol:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:5,pageNumber:1,pageSizeOptions:[5,15,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.username&&(this.query.params.username=this.username),this.fetch()}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.fetch()}onSearch(){this.fetch()}onReset(){}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!0,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.roleMembersService.rolesNoMember(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}onSubmit(t){t.preventDefault();let r=this.query.results.rows.filter(({disabled:d})=>!d).filter(({id:d})=>this.query.tableCheckedId.has(d)),o="",m="";for(let d=0;d<r.length;d++)o=`${o},${r[d].id}`,m=`${m},${r[d].name}`;this.roleMembersService.addMember2Roles({username:this.username,roleId:o,roleName:m}).subscribe(d=>{this.query.results=d.data,this.query.submitLoading=!1,this.query.tableLoading=!1,0==d.code?(this.msg.success(this.i18n.fanyi("mxk.alert.operate.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.operate.error")),this.cdr.detectChanges()})}onClose(t){t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Lf),e.Y36(U),e.Y36(e.s_b),e.Y36(l.qu),e.Y36(q.dD),e.Y36(h.Oi),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-member-roles-editer"]],inputs:{username:"username"},decls:40,vars:42,consts:[[4,"nzModalTitle"],["nz-form","",1,"search__form",2,"margin-bottom","10px",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","14","nzSm","24"],["nzFor","name"],["nz-input","","name","roleName","placeholder","","id","roleName",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",2,"display","none",3,"click"],["nz-button","",1,"mx-sm",2,"display","none",3,"click"],["nz-button","","nzType","primary",3,"click"],["nzTableLayout","auto","nzSize","small","nzBordered","","nzShowSizeChanger","","nzWidth","100%",3,"nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],["nzAlign","center",2,"display","none"],["nzAlign","center"],[4,"ngFor","ngForOf"],["style","display: none",4,"nzModalFooter"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left",2,"display","none"],["nzAlign","left"],["nzAlign","center",4,"ngIf"],[2,"display","none"],["nz-button","","nzType","default",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,zt,3,3,"div",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(2,"div",2)(3,"div",3)(4,"nz-form-item")(5,"nz-form-label",4),e._uU(6),e.ALo(7,"i18n"),e.qZA(),e.TgZ(8,"nz-form-control")(9,"input",5),e.NdJ("ngModelChange",function(o){return n.query.params.roleName=o}),e.qZA()()()(),e.TgZ(10,"div",6)(11,"button",7),e._uU(12),e.ALo(13,"i18n"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return n.onReset()}),e._uU(15),e.ALo(16,"i18n"),e.qZA(),e.TgZ(17,"button",9),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(18),e.ALo(19,"i18n"),e.ALo(20,"i18n"),e.qZA(),e.TgZ(21,"button",10),e.NdJ("click",function(o){return n.onSubmit(o)}),e._uU(22),e.ALo(23,"i18n"),e.qZA()()()(),e.TgZ(24,"nz-table",11,12),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(26,"thead")(27,"tr"),e._UZ(28,"th"),e.TgZ(29,"th",13),e._uU(30,"Id"),e.qZA(),e.TgZ(31,"th",14),e._uU(32),e.ALo(33,"i18n"),e.qZA(),e.TgZ(34,"th",14),e._uU(35),e.ALo(36,"i18n"),e.qZA()()(),e.TgZ(37,"tbody"),e.YNc(38,Zt,10,7,"tr",15),e.qZA()(),e.YNc(39,bt,7,6,"div",16)),2&t&&(e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(40,Ct)),e.xp6(4),e.Oqu(e.lcZ(7,24,"mxk.roles.name")),e.xp6(3),e.Q6J("ngModel",n.query.params.roleName)("ngModelOptions",e.DdM(41,Tt)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:10),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(13,26,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(16,28,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(19,30,"mxk.text.collapse"):e.lcZ(20,32,"mxk.text.expand"),""),e.xp6(4),e.Oqu(e.lcZ(23,34,"mxk.text.confirm")),e.xp6(2),e.Q6J("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(8),e.Oqu(e.lcZ(33,36,"mxk.roles.name")),e.xp6(3),e.Oqu(e.lcZ(36,38,"mxk.roles.category")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows))},directives:[g.h1,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,y.Zp,l.Fj,l.JJ,l.On,Z.ix,b.dQ,C.w,a.N8,a.Om,a.$Z,a.Uo,a._C,a.UX,a.p0,_.sg,a.h7,_.O5,g.Uh],pipes:[h.Ck],styles:[""]}),i})();function kt(i,s){1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.text.add")," "))}function At(i,s){1&i&&e._UZ(0,"i",21)}function vt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",18),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.id,r)}),e.qZA(),e.TgZ(2,"td",19),e._uU(3),e.qZA(),e.TgZ(4,"td",19),e._uU(5),e.qZA(),e.TgZ(6,"td",19),e._uU(7),e.qZA(),e.TgZ(8,"td",19),e._uU(9),e.qZA(),e.TgZ(10,"td",19),e._uU(11),e.qZA(),e.TgZ(12,"td",15),e._uU(13),e.ALo(14,"i18n"),e.ALo(15,"i18n"),e.qZA(),e.TgZ(16,"td",15),e.YNc(17,At,1,0,"i",20),e.qZA()()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(2),e.hij(" ",t.username,""),e.xp6(2),e.hij(" ",t.displayName,""),e.xp6(2),e.hij(" ",t.employeeNumber,""),e.xp6(2),e.hij(" ",t.department,""),e.xp6(2),e.hij(" ",t.jobTitle,""),e.xp6(2),e.hij(" ",1==t.gender?e.lcZ(14,9,"mxk.users.gender.female"):e.lcZ(15,11,"mxk.users.gender.male"),""),e.xp6(4),e.Q6J("ngIf",1==t.dynamic)}}function St(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",22)(1,"button",23),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onClose(r)}),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"button",10),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onSubmit(r)}),e._uU(5),e.ALo(6,"i18n"),e.qZA()()}2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"mxk.text.close")),e.xp6(3),e.Oqu(e.lcZ(6,4,"mxk.text.submit")))}const Mt=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}},Ot=function(){return{standalone:!0}};let $=(()=>{class i{constructor(t,n,r,o,m,d,z){this.modalRef=t,this.roleMembersService=n,this.viewContainerRef=r,this.fb=o,this.msg=m,this.i18n=d,this.cdr=z,this.query={params:{name:"",displayName:"",username:"",roleId:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:5,pageNumber:1,pageSizeOptions:[5,15,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.roleId&&(this.query.params.roleId=this.roleId,this.fetch())}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.fetch()}onSearch(){this.fetch()}onReset(){}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.roleMembersService.memberOut(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}onSubmit(t){t.preventDefault();let r=this.query.results.rows.filter(({disabled:d})=>!d).filter(({id:d})=>this.query.tableCheckedId.has(d)),o="",m="";for(let d=0;d<r.length;d++)o=`${o},${r[d].id}`,m=`${m},${r[d].username}`;this.roleMembersService.add({type:"USER",roleId:this.roleId,memberId:o,memberName:m}).subscribe(d=>{this.query.results=d.data,this.query.submitLoading=!1,this.query.tableLoading=!1,0==d.code?(this.msg.success(this.i18n.fanyi("mxk.alert.operate.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.operate.error")),this.cdr.detectChanges()})}onClose(t){t.preventDefault()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Lf),e.Y36(U),e.Y36(e.s_b),e.Y36(l.qu),e.Y36(q.dD),e.Y36(h.Oi),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-role-members-editer"]],inputs:{roleId:"roleId",isEdit:"isEdit"},decls:52,vars:56,consts:[[4,"nzModalTitle"],["nz-form","",1,"search__form",2,"margin-bottom","10px",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","14","nzSm","24"],["nzFor","username"],["nz-input","","name","username","placeholder","","id","username",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",2,"display","none",3,"click"],["nz-button","",1,"mx-sm",2,"display","none",3,"click"],["nz-button","","nzType","primary",3,"click"],["nzTableLayout","auto","nzSize","small","nzBordered","","nzShowSizeChanger","","nzWidth","100%",3,"nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzAlign","center",2,"display","none"],["nzAlign","center"],[4,"ngFor","ngForOf"],["style","display: none",4,"nzModalFooter"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left"],["nz-icon","","nzType","check-circle","nzTheme","fill","style","color: green",4,"ngIf"],["nz-icon","","nzType","check-circle","nzTheme","fill",2,"color","green"],[2,"display","none"],["nz-button","","nzType","default",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,kt,3,3,"div",0),e.TgZ(1,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(2,"div",2)(3,"div",3)(4,"nz-form-item")(5,"nz-form-label",4),e._uU(6),e.ALo(7,"i18n"),e.qZA(),e.TgZ(8,"nz-form-control")(9,"input",5),e.NdJ("ngModelChange",function(o){return n.query.params.username=o}),e.qZA()()()(),e.TgZ(10,"div",6)(11,"button",7),e._uU(12),e.ALo(13,"i18n"),e.qZA(),e.TgZ(14,"button",8),e.NdJ("click",function(){return n.onReset()}),e._uU(15),e.ALo(16,"i18n"),e.qZA(),e.TgZ(17,"button",9),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(18),e.ALo(19,"i18n"),e.ALo(20,"i18n"),e.qZA(),e.TgZ(21,"button",10),e.NdJ("click",function(o){return n.onSubmit(o)}),e._uU(22),e.ALo(23,"i18n"),e.qZA()()()(),e.TgZ(24,"nz-table",11,12),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(26,"thead")(27,"tr")(28,"th",13),e.NdJ("nzCheckedChange",function(o){return n.onTableAllChecked(o)}),e.qZA(),e.TgZ(29,"th",14),e._uU(30,"Id"),e.qZA(),e.TgZ(31,"th",15),e._uU(32),e.ALo(33,"i18n"),e.qZA(),e.TgZ(34,"th",15),e._uU(35),e.ALo(36,"i18n"),e.qZA(),e.TgZ(37,"th",15),e._uU(38),e.ALo(39,"i18n"),e.qZA(),e.TgZ(40,"th",15),e._uU(41),e.ALo(42,"i18n"),e.qZA(),e.TgZ(43,"th",15),e._uU(44),e.ALo(45,"i18n"),e.qZA(),e.TgZ(46,"th",15),e._uU(47),e.ALo(48,"i18n"),e.qZA()()(),e.TgZ(49,"tbody"),e.YNc(50,vt,18,13,"tr",16),e.qZA()(),e.YNc(51,St,7,6,"div",17)),2&t&&(e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(54,Mt)),e.xp6(4),e.Oqu(e.lcZ(7,30,"mxk.users.username")),e.xp6(3),e.Q6J("ngModel",n.query.params.username)("ngModelOptions",e.DdM(55,Ot)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:10),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(13,32,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(16,34,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(19,36,"mxk.text.collapse"):e.lcZ(20,38,"mxk.text.expand"),""),e.xp6(4),e.Oqu(e.lcZ(23,40,"mxk.text.confirm")),e.xp6(2),e.Q6J("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(4),e.Q6J("nzChecked",n.query.checked)("nzIndeterminate",n.query.indeterminate),e.xp6(4),e.Oqu(e.lcZ(33,42,"mxk.users.username")),e.xp6(3),e.Oqu(e.lcZ(36,44,"mxk.users.displayName")),e.xp6(3),e.Oqu(e.lcZ(39,46,"mxk.users.employeeNumber")),e.xp6(3),e.Oqu(e.lcZ(42,48,"mxk.users.department")),e.xp6(3),e.Oqu(e.lcZ(45,50,"mxk.users.jobTitle")),e.xp6(3),e.Oqu(e.lcZ(48,52,"mxk.users.gender")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows))},directives:[g.h1,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,y.Zp,l.Fj,l.JJ,l.On,Z.ix,b.dQ,C.w,a.N8,a.Om,a.$Z,a.Uo,a._C,a.g6,a.UX,a.p0,_.sg,a.h7,_.O5,O.Ls,g.Uh],pipes:[h.Ck],styles:[""]}),i})();function Lt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",24),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onSelect(r)}),e._uU(1),e.ALo(2,"i18n"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.text.select")))}function Nt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(r){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().onDelete(r,o.id)}),e._uU(1),e.ALo(2,"i18n"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.text.delete")))}function Jt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",25),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.id,r)}),e.qZA(),e.TgZ(2,"td",26),e._uU(3),e.qZA(),e.TgZ(4,"td",26),e._uU(5),e.qZA(),e.TgZ(6,"td",26),e._uU(7),e.qZA(),e.TgZ(8,"td",26),e._uU(9),e.qZA(),e.TgZ(10,"td",26),e._uU(11),e.qZA(),e.TgZ(12,"td",21),e._uU(13),e.ALo(14,"i18n"),e.ALo(15,"i18n"),e.qZA(),e.TgZ(16,"td",27)(17,"div",28),e.YNc(18,Nt,3,3,"button",29),e.qZA()()()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(2),e.hij(" ",t.roleName,""),e.xp6(2),e.hij(" ",t.username,""),e.xp6(2),e.hij(" ",t.displayName,""),e.xp6(2),e.hij(" ",t.department,""),e.xp6(2),e.hij(" ",t.jobTitle,""),e.xp6(2),e.hij(" ",1==t.gender?e.lcZ(14,9,"mxk.users.gender.female"):e.lcZ(15,11,"mxk.users.gender.male"),""),e.xp6(5),e.Q6J("ngIf","static"==t.category)}}const It=function(){return{xs:8,sm:8,md:24,lg:24,xl:48,xxl:48}},B=function(){return{standalone:!0}},Pt=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}};let X=(()=>{class i{constructor(t,n,r,o,m,d,z,M){this.modalService=t,this.roleMembersService=n,this.viewContainerRef=r,this.fb=o,this.msg=m,this.i18n=d,this.route=z,this.cdr=M,this.query={params:{roleName:"",displayName:"",username:"",roleId:"",appName:"",appId:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:10,pageNumber:1,pageSizeOptions:[10,20,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableInitialize:!0,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.route.snapshot.queryParams.username&&(this.query.params.username=this.route.snapshot.queryParams.username),this.route.snapshot.queryParams.roleId&&(this.query.params.roleId=this.route.snapshot.queryParams.roleId,this.query.params.roleName=this.route.snapshot.queryParams.roleName),this.query.tableInitialize=!1}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.query.tableInitialize||this.fetch()}onSearch(){this.fetch()}onReset(){this.query.params.username="",this.query.params.roleId="",this.query.params.roleName="",this.fetch()}onBatchDelete(t){t.preventDefault(),this.roleMembersService.delete((0,A.$$)(this.query.tableCheckedId)).subscribe(n=>{0==n.code?(this.msg.success(this.i18n.fanyi("mxk.alert.delete.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.delete.error")),this.cdr.detectChanges()})}onAdd(t){t.preventDefault(),""!=this.query.params.username?this.modalService.create({nzContent:j,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{username:this.query.params.username},nzWidth:700,nzOnOk:()=>new Promise(r=>setTimeout(r,1e3))}).afterClose.subscribe(r=>{r.refresh&&this.fetch()}):""!=this.query.params.roleId&&this.modalService.create({nzContent:$,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{isEdit:!1,roleId:this.query.params.roleId},nzWidth:700,nzOnOk:()=>new Promise(r=>setTimeout(r,1e3))}).afterClose.subscribe(r=>{r.refresh&&this.fetch()})}onSelect(t){t.preventDefault(),this.modalService.create({nzContent:P,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{},nzWidth:700,nzOnOk:()=>new Promise(r=>setTimeout(r,1e3))}).afterClose.subscribe(r=>{r.refresh&&(this.query.params.roleName=r.data.roleName,this.query.params.roleId=r.data.id,console.log(r),this.fetch())})}onDelete(t,n){t.preventDefault(),this.roleMembersService.delete(n).subscribe(r=>{0==r.code?(this.msg.success(this.i18n.fanyi("mxk.alert.delete.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.delete.error")),this.cdr.detectChanges()})}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.roleMembersService.member(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,console.log(t.data),this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Sf),e.Y36(U),e.Y36(e.s_b),e.Y36(l.qu),e.Y36(q.dD),e.Y36(h.Oi),e.Y36(k.gz),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-role-members"]],decls:70,vars:76,consts:[[3,"nzBordered"],["nz-form","",1,"search__form",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","8","nzSm","24"],["nzFor","roleName"],["nzSearch","",3,"nzAddOnAfter"],["nz-input","","name","roleName","readonly","","placeholder","","id","roleName",3,"ngModel","ngModelOptions","ngModelChange"],["suffixButton",""],["nzFor","name"],["nz-input","","name","username","placeholder","","id","username",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",3,"click"],["nz-button","",1,"mx-sm",2,"display","none",3,"click"],["nz-col","",1,"table-list-toolbar",3,"nzSpan"],["nz-button","","type","button",3,"nzType","click"],["nz-button","","type","button","nzDanger","",1,"mx-sm",3,"nzType","click"],["nz-col","","nzMd","24","nzSm","24"],["nzTableLayout","auto","nzSize","small","nzBordered","","nzShowSizeChanger","",3,"nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzAlign","center"],["nzAlign","center",1,"table_cell_action_1"],[4,"ngFor","ngForOf"],["nz-button","","nzType","primary","nzSearch","",3,"click"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left"],["nzAlign","center","nzBreakWord","false"],["nz-col",""],["nz-button","","type","button","nzDanger","",3,"click",4,"ngIf"],["nz-button","","type","button","nzDanger","",3,"click"]],template:function(t,n){if(1&t&&(e._UZ(0,"page-header"),e.TgZ(1,"nz-card",0)(2,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(3,"div",2)(4,"div",3)(5,"nz-form-item")(6,"nz-form-label",4),e._uU(7),e.ALo(8,"i18n"),e.qZA(),e.TgZ(9,"nz-form-control")(10,"nz-input-group",5)(11,"input",6),e.NdJ("ngModelChange",function(o){return n.query.params.roleName=o}),e.qZA()(),e.YNc(12,Lt,3,3,"ng-template",null,7,e.W1O),e.qZA()()(),e.TgZ(14,"div",3)(15,"nz-form-item")(16,"nz-form-label",8),e._uU(17),e.ALo(18,"i18n"),e.qZA(),e.TgZ(19,"nz-form-control")(20,"input",9),e.NdJ("ngModelChange",function(o){return n.query.params.username=o}),e.qZA()()()(),e.TgZ(21,"div",10)(22,"button",11),e._uU(23),e.ALo(24,"i18n"),e.qZA(),e.TgZ(25,"button",12),e.NdJ("click",function(){return n.onReset()}),e._uU(26),e.ALo(27,"i18n"),e.qZA(),e.TgZ(28,"button",13),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(29),e.ALo(30,"i18n"),e.ALo(31,"i18n"),e.qZA()()()()(),e.TgZ(32,"nz-card",0)(33,"div",2)(34,"div",14)(35,"button",15),e.NdJ("click",function(o){return n.onAdd(o)}),e._uU(36),e.ALo(37,"i18n"),e.qZA(),e.TgZ(38,"button",16),e.NdJ("click",function(o){return n.onBatchDelete(o)}),e._uU(39),e.ALo(40,"i18n"),e.qZA()(),e.TgZ(41,"div",17)(42,"nz-table",18,19),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(44,"thead")(45,"tr")(46,"th",20),e.NdJ("nzCheckedChange",function(o){return n.onTableAllChecked(o)}),e.qZA(),e.TgZ(47,"th",21),e._uU(48),e.ALo(49,"i18n"),e.qZA(),e.TgZ(50,"th",21),e._uU(51),e.ALo(52,"i18n"),e.qZA(),e.TgZ(53,"th",21),e._uU(54),e.ALo(55,"i18n"),e.qZA(),e.TgZ(56,"th",21),e._uU(57),e.ALo(58,"i18n"),e.qZA(),e.TgZ(59,"th",21),e._uU(60),e.ALo(61,"i18n"),e.qZA(),e.TgZ(62,"th",21),e._uU(63),e.ALo(64,"i18n"),e.qZA(),e.TgZ(65,"th",22),e._uU(66),e.ALo(67,"i18n"),e.qZA()()(),e.TgZ(68,"tbody"),e.YNc(69,Jt,19,13,"tr",23),e.qZA()()()()()),2&t){const r=e.MAs(13);e.xp6(1),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(72,It)),e.xp6(4),e.Oqu(e.lcZ(8,42,"mxk.roles.name")),e.xp6(3),e.Q6J("nzAddOnAfter",r),e.xp6(1),e.Q6J("ngModel",n.query.params.roleName)("ngModelOptions",e.DdM(73,B)),e.xp6(6),e.Oqu(e.lcZ(18,44,"mxk.users.username")),e.xp6(3),e.Q6J("ngModel",n.query.params.username)("ngModelOptions",e.DdM(74,B)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:8),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(24,46,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(27,48,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(30,50,"mxk.text.collapse"):e.lcZ(31,52,"mxk.text.expand"),""),e.xp6(3),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzGutter",e.DdM(75,Pt)),e.xp6(1),e.Q6J("nzSpan",24),e.xp6(1),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(37,54,"mxk.text.add")),e.xp6(2),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(40,56,"mxk.text.delete")),e.xp6(3),e.Q6J("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(4),e.Q6J("nzChecked",n.query.checked)("nzIndeterminate",n.query.indeterminate),e.xp6(2),e.Oqu(e.lcZ(49,58,"mxk.roles.name")),e.xp6(3),e.Oqu(e.lcZ(52,60,"mxk.users.username")),e.xp6(3),e.Oqu(e.lcZ(55,62,"mxk.users.displayName")),e.xp6(3),e.Oqu(e.lcZ(58,64,"mxk.users.department")),e.xp6(3),e.Oqu(e.lcZ(61,66,"mxk.users.jobTitle")),e.xp6(3),e.Oqu(e.lcZ(64,68,"mxk.users.gender")),e.xp6(3),e.Oqu(e.lcZ(67,70,"mxk.text.action")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows)}},directives:[L.q,v.bd,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,C.w,y.gB,y.Zp,l.Fj,l.JJ,l.On,Z.ix,b.dQ,a.N8,a.Om,a.$Z,a.Uo,a._C,a.g6,a.UX,a.p0,_.sg,a.h7,a.bF,_.O5],pipes:[h.Ck],styles:[""]}),i})();var Ut=c(8157);class Dt extends Ut.e{constructor(){super(),this.picker_resumeTime=new Date((0,p.Z)(new Date,"yyyy-MM-dd 00:00:00")),this.picker_suspendTime=new Date((0,p.Z)(new Date,"yyyy-MM-dd 00:00:00"))}init(s){Object.assign(this,s),1==this.status&&(this.switch_status=!0),""!=this.resumeTime&&(this.picker_resumeTime=new Date((0,p.Z)(new Date,`yyyy-MM-dd ${this.resumeTime}:00`))),""!=this.suspendTime&&(this.picker_suspendTime=new Date((0,p.Z)(new Date,`yyyy-MM-dd ${this.suspendTime}:00`)))}trans(){this.status=this.switch_status?1:0,this.picker_resumeTime&&(this.resumeTime=(0,p.Z)(this.picker_resumeTime,"HH:mm")),this.picker_suspendTime&&(this.suspendTime=(0,p.Z)(this.picker_suspendTime,"HH:mm"))}}var Qt=c(5889),Ft=c(4790),Rt=c(1457),D=c(3868),Et=c(4173),wt=c(4379);function Yt(i,s){if(1&i&&(e.TgZ(0,"div"),e._uU(1),e.ALo(2,"i18n"),e.ALo(3,"i18n"),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij(" ",t.isEdit?e.lcZ(2,1,"mxk.text.edit"):e.lcZ(3,3,"mxk.text.add")," ")}}const x=function(){return{standalone:!0}};function Ht(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"nz-form-item")(1,"nz-form-label",21),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"nz-form-control",22)(5,"nz-time-picker",23),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().form.model.picker_resumeTime=r}),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("nzSm",6)("nzXs",24),e.xp6(1),e.Oqu(e.lcZ(3,7,"mxk.roles.resumeTime")),e.xp6(2),e.Q6J("nzSm",18)("nzXs",24),e.xp6(1),e.Q6J("ngModel",t.form.model.picker_resumeTime)("ngModelOptions",e.DdM(9,x))}}function jt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"nz-form-item")(1,"nz-form-label",24),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"nz-form-control",25)(5,"nz-time-picker",26),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().form.model.picker_suspendTime=r}),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("nzSm",6)("nzXs",24),e.xp6(1),e.Oqu(e.lcZ(3,7,"mxk.roles.suspendTime")),e.xp6(2),e.Q6J("nzSm",18)("nzXs",24),e.xp6(1),e.Q6J("ngModel",t.form.model.picker_suspendTime)("ngModelOptions",e.DdM(9,x))}}function $t(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"nz-form-item")(1,"nz-form-label",27),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"nz-form-control",28)(5,"input",29),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().form.model.orgIdsList=r}),e.qZA(),e.TgZ(6,"nz-tree-select",30),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().selectValues=r}),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("nzSm",6)("nzXs",24),e.xp6(1),e.Oqu(e.lcZ(3,12,"mxk.roles.orgIdsList")),e.xp6(2),e.Q6J("nzSm",18)("nzXs",24),e.xp6(1),e.Q6J("ngModel",t.form.model.orgIdsList)("ngModelOptions",e.DdM(14,x)),e.xp6(1),e.Q6J("nzMaxTagCount",3)("ngModel",t.selectValues)("ngModelOptions",e.DdM(15,x))("nzNodes",t.treeNodes.nodes)("nzCheckStrictly",!0)}}function Bt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"nz-form-item")(1,"nz-form-label",31),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"nz-form-control",32)(5,"textarea",33),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().form.model.filters=r}),e.qZA()()()}if(2&i){const t=e.oxw();e.xp6(1),e.Q6J("nzSm",6)("nzXs",24),e.xp6(1),e.Oqu(e.lcZ(3,7,"mxk.roles.filters")),e.xp6(2),e.Q6J("nzSm",18)("nzXs",24),e.xp6(1),e.Q6J("ngModel",t.form.model.filters)("ngModelOptions",e.DdM(9,x))}}function Xt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"button",34),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onClose(r)}),e._uU(2),e.ALo(3,"i18n"),e.qZA(),e.TgZ(4,"button",35),e.NdJ("click",function(r){return e.CHM(t),e.oxw().onSubmit(r)}),e._uU(5),e.ALo(6,"i18n"),e.qZA()()}2&i&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"mxk.text.close")),e.xp6(3),e.Oqu(e.lcZ(6,4,"mxk.text.submit")))}let Q=(()=>{class i{constructor(t,n,r,o,m,d,z){this.modalRef=t,this.rolesService=n,this.orgsService=r,this.fb=o,this.msg=m,this.i18n=d,this.cdr=z,this.form={submitting:!1,model:new Dt},this.treeNodes=new Qt.X(!1),this.selectValues=[],this.formGroup=new l.cw({})}ngOnInit(){this.tree(),this.isEdit&&this.rolesService.get(`${this.id}`).subscribe(t=>{this.form.model.init(t.data),this.selectValues=this.form.model.orgIdsList.split(","),this.cdr.detectChanges()})}tree(){this.orgsService.tree({}).subscribe(t=>{this.treeNodes.init(t.data),this.treeNodes.nodes=this.treeNodes.build(),this.cdr.detectChanges()})}onClose(t){t.preventDefault(),this.modalRef.destroy({refresh:!1})}onSubmit(t){t.preventDefault(),this.form.submitting=!0,this.form.model.trans(),this.form.model.orgIdsList="",this.selectValues.forEach(n=>{this.form.model.orgIdsList=`${this.form.model.orgIdsList+n},`}),(this.isEdit?this.rolesService.update(this.form.model):this.rolesService.add(this.form.model)).subscribe(n=>{0==n.code?this.msg.success(this.i18n.fanyi(this.isEdit?"mxk.alert.update.success":"mxk.alert.add.success")):this.msg.error(this.i18n.fanyi(this.isEdit?"mxk.alert.update.error":"mxk.alert.add.error")),this.form.submitting=!1,this.modalRef.destroy({refresh:!0}),this.cdr.detectChanges()})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Lf),e.Y36(I.f),e.Y36(Ft.z),e.Y36(l.qu),e.Y36(q.dD),e.Y36(h.Oi),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-role-editer"]],inputs:{id:"id",isEdit:"isEdit"},decls:44,vars:60,consts:[[4,"nzModalTitle"],["nz-form","","se-container","1",3,"formGroup","ngSubmit"],[1,"d-none"],["nzRequired","","nzFor","id",3,"nzMd"],["nzErrorTip","The input is not valid id!",3,"nzMd"],["nz-input","","name","id",3,"ngModel","disabled","ngModelOptions","ngModelChange"],["nzRequired","","nzFor","roleCode",3,"nzMd"],["nz-input","","name","roleCode",3,"ngModel","ngModelOptions","ngModelChange"],["nzRequired","","nzFor","roleName",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid minLength!",3,"nzSm","nzMd","nzXs","nzXl"],["nz-input","","name","roleName","id","roleName",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","dynamic",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid status!",3,"nzSm","nzXs"],["nzButtonStyle","solid",3,"ngModel","ngModelOptions","ngModelChange"],["nz-radio-button","","nzValue","static"],["nz-radio-button","","nzValue","dynamic"],[4,"ngIf"],["nzFor","description",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid encoding!",3,"nzSm","nzXs"],["rows","4","nz-input","","nz-input","","name","description","id","description",3,"ngModel","ngModelOptions","ngModelChange"],[4,"nzModalFooter"],["nzFor","resumeTime",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid port!",3,"nzSm","nzXs"],["nzFormat","HH:mm","name","picker_resumeTime","id","picker_resumeTime",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","suspendTime",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid suspendTime!",3,"nzSm","nzXs"],["nzFormat","HH:mm","name","picker_suspendTime","id","picker_suspendTime",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","orgIdsList",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid upperCase!",3,"nzSm","nzXs"],["type","hidden","nz-input","","name","orgIdsList","id","orgIdsList",3,"ngModel","ngModelOptions","ngModelChange"],["nzVirtualHeight","300px","nzCheckable","","nzPlaceHolder","Please select",3,"nzMaxTagCount","ngModel","ngModelOptions","nzNodes","nzCheckStrictly","ngModelChange"],["nzFor","filters",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid filters!",3,"nzSm","nzXs"],["rows","4","nz-input","","nz-input","","name","filters","id","filters",3,"ngModel","ngModelOptions","ngModelChange"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"click"]],template:function(t,n){1&t&&(e.YNc(0,Yt,4,5,"div",0),e.TgZ(1,"div")(2,"form",1),e.NdJ("ngSubmit",function(o){return n.onSubmit(o)}),e.TgZ(3,"nz-form-item",2)(4,"nz-form-label",3),e._uU(5),e.ALo(6,"i18n"),e.qZA(),e.TgZ(7,"nz-form-control",4)(8,"input",5),e.NdJ("ngModelChange",function(o){return n.form.model.id=o}),e.qZA()()(),e.TgZ(9,"nz-form-item")(10,"nz-form-label",6),e._uU(11),e.ALo(12,"i18n"),e.qZA(),e.TgZ(13,"nz-form-control",4)(14,"input",7),e.NdJ("ngModelChange",function(o){return n.form.model.roleCode=o}),e.qZA()()(),e.TgZ(15,"nz-form-item")(16,"nz-form-label",8),e._uU(17),e.ALo(18,"i18n"),e.qZA(),e.TgZ(19,"nz-form-control",9)(20,"input",10),e.NdJ("ngModelChange",function(o){return n.form.model.roleName=o}),e.qZA()()(),e.TgZ(21,"nz-form-item")(22,"nz-form-label",11),e._uU(23),e.ALo(24,"i18n"),e.qZA(),e.TgZ(25,"nz-form-control",12)(26,"nz-radio-group",13),e.NdJ("ngModelChange",function(o){return n.form.model.category=o}),e.TgZ(27,"label",14),e._uU(28),e.ALo(29,"i18n"),e.qZA(),e.TgZ(30,"label",15),e._uU(31),e.ALo(32,"i18n"),e.qZA()()()(),e.YNc(33,Ht,6,10,"nz-form-item",16),e.YNc(34,jt,6,10,"nz-form-item",16),e.YNc(35,$t,7,16,"nz-form-item",16),e.YNc(36,Bt,6,10,"nz-form-item",16),e.TgZ(37,"nz-form-item")(38,"nz-form-label",17),e._uU(39),e.ALo(40,"i18n"),e.qZA(),e.TgZ(41,"nz-form-control",18)(42,"textarea",19),e.NdJ("ngModelChange",function(o){return n.form.model.description=o}),e.qZA()()()()(),e.YNc(43,Xt,7,6,"div",20)),2&t&&(e.xp6(2),e.Q6J("formGroup",n.formGroup),e.xp6(2),e.Q6J("nzMd",6),e.xp6(1),e.Oqu(e.lcZ(6,41,"mxk.text.id")),e.xp6(2),e.Q6J("nzMd",18),e.xp6(1),e.s9C("disabled",n.isEdit),e.Q6J("ngModel",n.form.model.id)("ngModelOptions",e.DdM(55,x)),e.xp6(2),e.Q6J("nzMd",6),e.xp6(1),e.Oqu(e.lcZ(12,43,"mxk.text.id")),e.xp6(2),e.Q6J("nzMd",18),e.xp6(1),e.Q6J("ngModel",n.form.model.roleCode)("ngModelOptions",e.DdM(56,x)),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(1),e.Oqu(e.lcZ(18,45,"mxk.roles.name")),e.xp6(2),e.Q6J("nzSm",18)("nzMd",18)("nzXs",36)("nzXl",48),e.xp6(1),e.Q6J("ngModel",n.form.model.roleName)("ngModelOptions",e.DdM(57,x)),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(1),e.Oqu(e.lcZ(24,47,"mxk.roles.category")),e.xp6(2),e.Q6J("nzSm",14)("nzXs",24),e.xp6(1),e.Q6J("ngModel",n.form.model.category)("ngModelOptions",e.DdM(58,x)),e.xp6(2),e.Oqu(e.lcZ(29,49,"mxk.roles.category.static")),e.xp6(3),e.Oqu(e.lcZ(32,51,"mxk.roles.category.dynamic")),e.xp6(2),e.Q6J("ngIf","dynamic"==n.form.model.category),e.xp6(1),e.Q6J("ngIf","dynamic"==n.form.model.category),e.xp6(1),e.Q6J("ngIf","dynamic"==n.form.model.category),e.xp6(1),e.Q6J("ngIf","dynamic"==n.form.model.category),e.xp6(2),e.Q6J("nzSm",6)("nzXs",24),e.xp6(1),e.Oqu(e.lcZ(40,53,"mxk.text.description")),e.xp6(2),e.Q6J("nzSm",18)("nzXs",24),e.xp6(1),e.Q6J("ngModel",n.form.model.description)("ngModelOptions",e.DdM(59,x)))},directives:[g.h1,l._Y,l.JL,u.Lr,Rt.nV,l.sg,f.SK,u.Nx,f.t3,u.iK,u.Fd,y.Zp,l.Fj,l.JJ,l.On,D.Dg,D.Of,D.Bq,_.O5,Et.m4,wt.zr,g.Uh,Z.ix,b.dQ,C.w],pipes:[h.Ck],styles:["","nz-form-item[_ngcontent-%COMP%]{width:100%}"]}),i})();var F=c(3677),G=c(4219);function Gt(i,s){1&i&&(e.TgZ(0,"td",17),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.dynamic"),""))}function Kt(i,s){1&i&&(e.TgZ(0,"td",17),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.static"),""))}function Vt(i,s){1&i&&(e.TgZ(0,"td",17),e._uU(1),e.ALo(2,"i18n"),e.qZA()),2&i&&(e.xp6(1),e.hij(" ",e.lcZ(2,1,"mxk.roles.category.app"),""))}function Wt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"li",34),e.NdJ("click",function(r){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().onDelete(r,o.id)}),e._uU(1),e.ALo(2,"i18n"),e.qZA()}2&i&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"mxk.text.delete")))}function en(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",20),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.id,r)}),e.qZA(),e.TgZ(2,"td",21)(3,"span"),e._uU(4),e.qZA()(),e.TgZ(5,"td",22),e._uU(6),e.qZA(),e.YNc(7,Gt,3,3,"td",23),e.YNc(8,Kt,3,3,"td",23),e.YNc(9,Vt,3,3,"td",23),e.TgZ(10,"td",24),e._uU(11),e.qZA(),e.TgZ(12,"td",25)(13,"div",26)(14,"button",27),e.NdJ("click",function(r){const m=e.CHM(t).$implicit;return e.oxw().onEdit(r,m.id)}),e._uU(15),e.ALo(16,"i18n"),e.qZA(),e.TgZ(17,"button",28),e._uU(18),e.ALo(19,"i18n"),e._UZ(20,"i",29),e.qZA(),e.TgZ(21,"nz-dropdown-menu",null,30)(23,"ul",31)(24,"li",32),e.NdJ("click",function(r){const m=e.CHM(t).$implicit;return e.oxw().onMembers(r,m.id,m.roleName)}),e._uU(25),e.ALo(26,"i18n"),e.qZA(),e.TgZ(27,"li",32),e.NdJ("click",function(r){const m=e.CHM(t).$implicit;return e.oxw().onPermissions(r,m.id,m.roleName)}),e._uU(28),e.ALo(29,"i18n"),e.qZA(),e.YNc(30,Wt,3,3,"li",33),e.qZA()()()()()}if(2&i){const t=s.$implicit,n=e.MAs(22),r=e.oxw();e.xp6(1),e.Q6J("nzChecked",r.query.tableCheckedId.has(t.id))("nzDisabled",t.disabled),e.xp6(3),e.Oqu(t.id),e.xp6(2),e.Oqu(t.roleName),e.xp6(1),e.Q6J("ngIf","dynamic"==t.category),e.xp6(1),e.Q6J("ngIf","static"==t.category),e.xp6(1),e.Q6J("ngIf","app"==t.category),e.xp6(2),e.Oqu(t.description),e.xp6(4),e.Oqu(e.lcZ(16,14,"mxk.text.edit")),e.xp6(2),e.Q6J("nzDropdownMenu",n),e.xp6(1),e.hij(" ",e.lcZ(19,16,"mxk.text.moreaction")," "),e.xp6(7),e.Oqu(e.lcZ(26,18,"mxk.roles.member")),e.xp6(3),e.Oqu(e.lcZ(29,20,"mxk.roles.permissions")),e.xp6(2),e.Q6J("ngIf","ROLE_ADMINISTRATORS"!=t.roleCode&&"ROLE_ALL_USER"!=t.roleCode&&"ROLE_MANAGERS"!=t.roleCode)}}const tn=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}},nn=function(){return{standalone:!0}};let K=(()=>{class i{constructor(t,n,r,o,m,d,z,M){this.modalService=t,this.viewContainerRef=n,this.rolesService=r,this.fb=o,this.msg=m,this.router=d,this.i18n=z,this.cdr=M,this.query={params:{roleName:"",displayName:"",employeeNumber:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:10,pageNumber:1,pageSizeOptions:[10,20,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.fetch()}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.fetch()}onSearch(){this.fetch()}onReset(){}onBatchDelete(t){t.preventDefault(),this.rolesService.delete((0,A.$$)(this.query.tableCheckedId)).subscribe(n=>{0==n.code?(this.msg.success(this.i18n.fanyi("mxk.alert.delete.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.delete.error")),this.cdr.detectChanges()})}onAdd(t){t.preventDefault(),this.modalService.create({nzContent:Q,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{isEdit:!1,id:""},nzOnOk:()=>new Promise(r=>setTimeout(r,1e3))}).afterClose.subscribe(r=>{r.refresh&&this.fetch()})}onEdit(t,n){t.preventDefault(),this.modalService.create({nzContent:Q,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{isEdit:!0,id:n},nzOnOk:()=>new Promise(o=>setTimeout(o,1e3))}).afterClose.subscribe(o=>{o.refresh&&this.fetch()})}onDelete(t,n){t.preventDefault(),this.rolesService.delete(n).subscribe(r=>{0==r.code?(this.msg.success(this.i18n.fanyi("mxk.alert.delete.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.delete.error")),this.cdr.detectChanges()})}onMembers(t,n,r){this.router.navigateByUrl(`/access/rolemembers?roleId=${n}&roleName=${r}`)}onPermissions(t,n,r){this.router.navigateByUrl(`/access/permissions?roleId=${n}&roleName=${r}`)}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.rolesService.fetch(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(g.Sf),e.Y36(e.s_b),e.Y36(I.f),e.Y36(l.qu),e.Y36(q.dD),e.Y36(k.F0),e.Y36(h.Oi),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-roles"]],decls:51,vars:57,consts:[[3,"nzBordered"],["nz-form","",1,"search__form",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","16","nzSm","24"],["nzFor","name"],["nz-input","","name","roleName","placeholder","","id","roleName",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",2,"display","none",3,"click"],["nz-button","",1,"mx-sm",2,"display","none",3,"click"],["nz-col","",1,"table-list-toolbar",3,"nzSpan"],["nz-button","","type","button",3,"nzType","click"],["nz-button","","type","button","nzDanger","",1,"mx-sm",3,"nzType","click"],["nzTableLayout","auto","nzSize","small","nzBordered","","nzShowSizeChanger","","nzWidth","100%",3,"nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzAlign","center",2,"display","none"],["nzAlign","center"],["nzAlign","center",1,"table_cell_action_2"],[4,"ngFor","ngForOf"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left",2,"display","none"],["nzAlign","left","nzBreakWord","false"],["nzAlign","center",4,"ngIf"],["nzAlign","left"],["nzAlign","center","nzBreakWord","false"],["nz-col",""],["nz-button","","type","button",3,"click"],["nz-button","","nz-dropdown","",3,"nzDropdownMenu"],["nz-icon","","nzType","down"],["menuMoreAction","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","",3,"click"],["nz-menu-item","","nzDanger","",3,"click",4,"ngIf"],["nz-menu-item","","nzDanger","",3,"click"]],template:function(t,n){1&t&&(e._UZ(0,"page-header"),e.TgZ(1,"nz-card",0)(2,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(3,"div",2)(4,"div",3)(5,"nz-form-item")(6,"nz-form-label",4),e._uU(7),e.ALo(8,"i18n"),e.qZA(),e.TgZ(9,"nz-form-control")(10,"input",5),e.NdJ("ngModelChange",function(o){return n.query.params.roleName=o}),e.qZA()()()(),e.TgZ(11,"div",6)(12,"button",7),e._uU(13),e.ALo(14,"i18n"),e.qZA(),e.TgZ(15,"button",8),e.NdJ("click",function(){return n.onReset()}),e._uU(16),e.ALo(17,"i18n"),e.qZA(),e.TgZ(18,"button",9),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(19),e.ALo(20,"i18n"),e.ALo(21,"i18n"),e.qZA()()()()(),e.TgZ(22,"nz-card")(23,"div",10)(24,"button",11),e.NdJ("click",function(o){return n.onAdd(o)}),e._uU(25),e.ALo(26,"i18n"),e.qZA(),e.TgZ(27,"button",12),e.NdJ("click",function(o){return n.onBatchDelete(o)}),e._uU(28),e.ALo(29,"i18n"),e.qZA()(),e.TgZ(30,"nz-table",13,14),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(32,"thead")(33,"tr")(34,"th",15),e.NdJ("nzCheckedChange",function(o){return n.onTableAllChecked(o)}),e.qZA(),e.TgZ(35,"th",16),e._uU(36,"Id"),e.qZA(),e.TgZ(37,"th",17),e._uU(38),e.ALo(39,"i18n"),e.qZA(),e.TgZ(40,"th",17),e._uU(41),e.ALo(42,"i18n"),e.qZA(),e.TgZ(43,"th",17),e._uU(44),e.ALo(45,"i18n"),e.qZA(),e.TgZ(46,"th",18),e._uU(47),e.ALo(48,"i18n"),e.qZA()()(),e.TgZ(49,"tbody"),e.YNc(50,en,31,22,"tr",19),e.qZA()()()),2&t&&(e.xp6(1),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(55,tn)),e.xp6(4),e.Oqu(e.lcZ(8,33,"mxk.roles.name")),e.xp6(3),e.Q6J("ngModel",n.query.params.roleName)("ngModelOptions",e.DdM(56,nn)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:8),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(14,35,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(17,37,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(20,39,"mxk.text.collapse"):e.lcZ(21,41,"mxk.text.expand"),""),e.xp6(4),e.Q6J("nzSpan",24),e.xp6(1),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(26,43,"mxk.text.add")),e.xp6(2),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(29,45,"mxk.text.delete")),e.xp6(2),e.Q6J("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(4),e.Q6J("nzChecked",n.query.checked)("nzIndeterminate",n.query.indeterminate),e.xp6(4),e.Oqu(e.lcZ(39,47,"mxk.roles.name")),e.xp6(3),e.Oqu(e.lcZ(42,49,"mxk.roles.category")),e.xp6(3),e.Oqu(e.lcZ(45,51,"mxk.text.description")),e.xp6(3),e.Oqu(e.lcZ(48,53,"mxk.text.action")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows))},directives:[L.q,v.bd,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,y.Zp,l.Fj,l.JJ,l.On,Z.ix,b.dQ,C.w,a.N8,a.Om,a.$Z,a.Uo,a._C,a.g6,a.UX,a.p0,_.sg,a.h7,a.bF,_.O5,F.wA,F.cm,O.Ls,F.RR,G.wO,G.r9],pipes:[h.Ck],styles:[""]}),i})(),rn=(()=>{class i extends N.b{constructor(t){super(t,"/access/session"),this._httpClient=t,this.server.urls.delete="/terminate"}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(J.eN))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var on=c(2905);const S=function(){return{standalone:!0}};function sn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"nz-form-item")(2,"nz-form-label",20),e._uU(3),e.ALo(4,"i18n"),e.qZA(),e.TgZ(5,"nz-form-control")(6,"input",21),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().query.params.employeeNumber=r}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"mxk.users.employeeNumber")),e.xp6(3),e.Q6J("ngModel",t.query.params.employeeNumber)("ngModelOptions",e.DdM(5,S))}}function an(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"nz-form-item")(2,"nz-form-label",22),e._uU(3),e.ALo(4,"i18n"),e.qZA(),e.TgZ(5,"nz-form-control")(6,"nz-date-picker",23),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().query.params.startDatePicker=r}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"mxk.text.startDate")),e.xp6(3),e.Q6J("ngModel",t.query.params.startDatePicker)("ngModelOptions",e.DdM(5,S))}}function ln(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",3)(1,"nz-form-item")(2,"nz-form-label",24),e._uU(3),e.ALo(4,"i18n"),e.qZA(),e.TgZ(5,"nz-form-control")(6,"nz-date-picker",25),e.NdJ("ngModelChange",function(r){return e.CHM(t),e.oxw().query.params.endDatePicker=r}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"mxk.text.endDate")),e.xp6(3),e.Q6J("ngModel",t.query.params.endDatePicker)("ngModelOptions",e.DdM(5,S))}}function dn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"tr")(1,"td",26),e.NdJ("nzCheckedChange",function(r){const m=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(m.sessionId,r)}),e.qZA(),e.TgZ(2,"td",27)(3,"span"),e._uU(4),e.qZA()(),e.TgZ(5,"td",27),e._uU(6),e.qZA(),e.TgZ(7,"td",27),e._uU(8),e.qZA(),e.TgZ(9,"td",27),e._uU(10),e.qZA(),e.TgZ(11,"td",27),e._uU(12),e.qZA(),e.TgZ(13,"td",27),e._uU(14),e.qZA(),e.TgZ(15,"td",27),e._uU(16),e.qZA(),e.TgZ(17,"td",27),e._uU(18),e.qZA(),e.TgZ(19,"td",27),e._uU(20),e.qZA()()}if(2&i){const t=s.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.sessionId))("nzDisabled",t.disabled),e.xp6(3),e.Oqu(t.sessionId),e.xp6(2),e.Oqu(t.username),e.xp6(2),e.Oqu(t.displayName),e.xp6(2),e.Oqu(t.provider),e.xp6(2),e.Oqu(t.loginType),e.xp6(2),e.Oqu(t.sourceIp),e.xp6(2),e.Oqu(t.browser),e.xp6(2),e.Oqu(t.platform),e.xp6(2),e.Oqu(t.loginTime)}}const mn=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}};const cn=[{path:"sessions",component:(()=>{class i{constructor(t,n,r,o,m){this.fb=t,this.sessionsService=n,this.msg=r,this.i18n=o,this.cdr=m,this.query={params:{username:"",displayName:"",employeeNumber:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:10,pageNumber:1,pageSizeOptions:[10,20,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.fetch()}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.fetch()}onSearch(){this.fetch()}onReset(){}onTerminate(t){t.preventDefault(),this.sessionsService.delete((0,A.$$)(this.query.tableCheckedId)).subscribe(n=>{0==n.code?(this.msg.success(this.i18n.fanyi("mxk.alert.operate.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.operate.error")),this.cdr.detectChanges()})}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,p.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,p.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.sessionsService.fetch(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(l.qu),e.Y36(rn),e.Y36(q.dD),e.Y36(h.Oi),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-sessions"]],decls:72,vars:79,consts:[[3,"nzBordered"],["nz-form","",1,"search__form",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","8","nzSm","24"],["nzFor","username"],["nz-input","","name","username","id","username",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","displayName"],["nz-input","","id","displayName","name","displayName",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","","nzMd","8","nzSm","24",4,"ngIf"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",3,"click"],["nz-button","",1,"mx-sm",3,"click"],["nz-col","",1,"table-list-toolbar",3,"nzSpan"],["nz-button","","type","button","nzDanger","",1,"mx-sm",3,"nzType","click"],["nzTableLayout","auto","nzSize","small","nzShowSizeChanger","",3,"nzBordered","nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzAlign","center"],[4,"ngFor","ngForOf"],["nzFor","employeeNumber"],["nz-input","","id","employeeNumber","name","employeeNumber",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","startDatePicker"],["nzShowTime","","nzFormat","yyyy-MM-dd HH:mm:ss","name","startDatePicker","nzPlaceHolder","startDatePicker",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","endDatePicker"],["nzShowTime","","nzFormat","yyyy-MM-dd HH:mm:ss","name","endDatePicker","nzPlaceHolder","endDatePicker",3,"ngModel","ngModelOptions","ngModelChange"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left"]],template:function(t,n){1&t&&(e._UZ(0,"page-header"),e.TgZ(1,"nz-card",0)(2,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(3,"div",2)(4,"div",3)(5,"nz-form-item")(6,"nz-form-label",4),e._uU(7),e.ALo(8,"i18n"),e.qZA(),e.TgZ(9,"nz-form-control")(10,"input",5),e.NdJ("ngModelChange",function(o){return n.query.params.username=o}),e.qZA()()()(),e.TgZ(11,"div",3)(12,"nz-form-item")(13,"nz-form-label",6),e._uU(14),e.ALo(15,"i18n"),e.qZA(),e.TgZ(16,"nz-form-control")(17,"input",7),e.NdJ("ngModelChange",function(o){return n.query.params.displayName=o}),e.qZA()()()(),e.YNc(18,sn,7,6,"div",8),e.YNc(19,an,7,6,"div",8),e.YNc(20,ln,7,6,"div",8),e.TgZ(21,"div",9)(22,"button",10),e._uU(23),e.ALo(24,"i18n"),e.qZA(),e.TgZ(25,"button",11),e.NdJ("click",function(){return n.onReset()}),e._uU(26),e.ALo(27,"i18n"),e.qZA(),e.TgZ(28,"button",12),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(29),e.ALo(30,"i18n"),e.ALo(31,"i18n"),e.qZA()()()()(),e.TgZ(32,"nz-card")(33,"div",13)(34,"button",14),e.NdJ("click",function(o){return n.onTerminate(o)}),e._uU(35),e.ALo(36,"i18n"),e.qZA()(),e.TgZ(37,"div",9)(38,"nz-table",15,16),e.NdJ("nzQueryParams",function(o){return n.onQueryParamsChange(o)}),e.TgZ(40,"thead")(41,"tr")(42,"th",17),e.NdJ("nzCheckedChange",function(o){return n.onTableAllChecked(o)}),e.qZA(),e.TgZ(43,"th",18),e._uU(44),e.ALo(45,"i18n"),e.qZA(),e.TgZ(46,"th",18),e._uU(47),e.ALo(48,"i18n"),e.qZA(),e.TgZ(49,"th",18),e._uU(50),e.ALo(51,"i18n"),e.qZA(),e.TgZ(52,"th",18),e._uU(53),e.ALo(54,"i18n"),e.qZA(),e.TgZ(55,"th",18),e._uU(56),e.ALo(57,"i18n"),e.qZA(),e.TgZ(58,"th",18),e._uU(59),e.ALo(60,"i18n"),e.qZA(),e.TgZ(61,"th",18),e._uU(62),e.ALo(63,"i18n"),e.qZA(),e.TgZ(64,"th",18),e._uU(65),e.ALo(66,"i18n"),e.qZA(),e.TgZ(67,"th",18),e._uU(68),e.ALo(69,"i18n"),e.qZA()()(),e.TgZ(70,"tbody"),e.YNc(71,dn,21,11,"tr",19),e.qZA()()()()),2&t&&(e.xp6(1),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(76,mn)),e.xp6(4),e.Oqu(e.lcZ(8,44,"mxk.users.username")),e.xp6(3),e.Q6J("ngModel",n.query.params.username)("ngModelOptions",e.DdM(77,S)),e.xp6(4),e.Oqu(e.lcZ(15,46,"mxk.users.displayName")),e.xp6(3),e.Q6J("ngModel",n.query.params.displayName)("ngModelOptions",e.DdM(78,S)),e.xp6(1),e.Q6J("ngIf",n.query.expandForm),e.xp6(1),e.Q6J("ngIf",n.query.expandForm),e.xp6(1),e.Q6J("ngIf",n.query.expandForm),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:8),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(24,48,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(27,50,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(30,52,"mxk.text.collapse"):e.lcZ(31,54,"mxk.text.expand"),""),e.xp6(4),e.Q6J("nzSpan",24),e.xp6(1),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(36,56,"mxk.text.terminate")),e.xp6(2),e.Q6J("nzSpan",24),e.xp6(1),e.Q6J("nzBordered",!0)("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(4),e.Q6J("nzChecked",n.query.checked)("nzIndeterminate",n.query.indeterminate),e.xp6(2),e.Oqu(e.lcZ(45,58,"mxk.history.login.sessionId")),e.xp6(3),e.Oqu(e.lcZ(48,60,"mxk.history.login.username")),e.xp6(3),e.Oqu(e.lcZ(51,62,"mxk.history.login.displayName")),e.xp6(3),e.Oqu(e.lcZ(54,64,"mxk.history.login.message")),e.xp6(3),e.Oqu(e.lcZ(57,66,"mxk.history.login.loginType")),e.xp6(3),e.Oqu(e.lcZ(60,68,"mxk.history.login.sourceIp")),e.xp6(3),e.Oqu(e.lcZ(63,70,"mxk.history.login.browser")),e.xp6(3),e.Oqu(e.lcZ(66,72,"mxk.history.login.platform")),e.xp6(3),e.Oqu(e.lcZ(69,74,"mxk.history.login.loginTime")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows))},directives:[L.q,v.bd,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,y.Zp,l.Fj,l.JJ,l.On,_.O5,on.uw,Z.ix,b.dQ,C.w,a.N8,a.Om,a.$Z,a.Uo,a._C,a.g6,a.UX,a.p0,_.sg,a.h7],pipes:[h.Ck],styles:[""]}),i})()},{path:"roles",component:K},{path:"rolemembers",component:X},{path:"permissions",component:H}];let un=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[O.PV,A.m8,_.ez,k.Bz.forChild(cn)],k.Bz]}),i})()}}]);
"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[10],{9010:(Je,M,l)=>{l.r(M),l.d(M,{PassportModule:()=>Me});var W=l(7629),t=l(5e3),H=l(7579),X=l(4968),K=l(727),tt=l(6451),et=l(9300),k=l(2722),nt=l(8675),I=l(4090),q=l(1721),it=l(655),L=l(4342),h=l(9808),P=l(647),J=l(969),Y=l(226);const ot=["processDotTemplate"],rt=["itemContainer"];function st(n,o){1&n&&t._UZ(0,"div",10)}function at(n,o){if(1&n&&(t.TgZ(0,"div",13),t._UZ(1,"nz-progress",14),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("nzPercent",e.nzPercentage)("nzWidth",40)("nzFormat",e.nullProcessFormat)("nzStrokeWidth",4)}}function lt(n,o){1&n&&(t.TgZ(0,"span",15),t._UZ(1,"i",16),t.qZA())}function ct(n,o){1&n&&(t.TgZ(0,"span",15),t._UZ(1,"i",17),t.qZA())}function pt(n,o){if(1&n&&(t.TgZ(0,"span",15),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.index+1," ")}}function ut(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"i",18),t.BQk()),2&n){const e=o.$implicit,i=t.oxw(3);t.xp6(1),t.Q6J("nzType",!i.oldAPIIcon&&e)("ngClass",i.oldAPIIcon&&e)}}function mt(n,o){if(1&n&&(t.TgZ(0,"span",15),t.YNc(1,ut,2,2,"ng-container",7),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("nzStringTemplateOutlet",e.nzIcon)}}function dt(n,o){if(1&n&&(t.YNc(0,at,2,4,"div",11),t.YNc(1,lt,2,0,"span",12),t.YNc(2,ct,2,0,"span",12),t.YNc(3,pt,2,1,"span",12),t.YNc(4,mt,2,1,"span",12)),2&n){const e=t.oxw();t.Q6J("ngIf",e.showProgress),t.xp6(1),t.Q6J("ngIf","finish"===e.nzStatus&&!e.nzIcon),t.xp6(1),t.Q6J("ngIf","error"===e.nzStatus),t.xp6(1),t.Q6J("ngIf",("process"===e.nzStatus||"wait"===e.nzStatus)&&!e.nzIcon),t.xp6(1),t.Q6J("ngIf",e.nzIcon)}}function ht(n,o){1&n&&t._UZ(0,"span",21)}function gt(n,o){}const ft=function(n,o,e){return{$implicit:n,status:o,index:e}};function _t(n,o){if(1&n&&(t.TgZ(0,"span",15),t.YNc(1,ht,1,0,"ng-template",null,19,t.W1O),t.YNc(3,gt,0,0,"ng-template",20),t.qZA()),2&n){const e=t.MAs(2),i=t.oxw();t.xp6(3),t.Q6J("ngTemplateOutlet",i.customProcessTemplate||e)("ngTemplateOutletContext",t.kEZ(2,ft,e,i.nzStatus,i.index))}}function zt(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.nzTitle)}}function vt(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Oqu(e.nzSubtitle)}}function xt(n,o){if(1&n&&(t.TgZ(0,"div",22),t.YNc(1,vt,2,1,"ng-container",7),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("nzStringTemplateOutlet",e.nzSubtitle)}}function Ct(n,o){if(1&n&&(t.ynx(0),t._uU(1),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.nzDescription)}}const yt=["*"];let Q=(()=>{class n{constructor(e,i,r){this.cdr=e,this.ngZone=i,this.destroy$=r,this.nzDisabled=!1,this.nzPercentage=null,this.isCustomStatus=!1,this._status="wait",this.oldAPIIcon=!0,this.direction="horizontal",this.index=0,this.last=!1,this.outStatus="process",this.showProcessDot=!1,this.clickable=!1,this.clickOutsideAngular$=new H.x,this.nullProcessFormat=()=>null,this._currentIndex=0}get nzStatus(){return this._status}set nzStatus(e){this._status=e,this.isCustomStatus=!0}get nzIcon(){return this._icon}set nzIcon(e){e instanceof t.Rgc||(this.oldAPIIcon="string"==typeof e&&e.indexOf("anticon")>-1),this._icon=e}get showProgress(){return null!==this.nzPercentage&&!this.nzIcon&&"process"===this.nzStatus&&this.nzPercentage>=0&&this.nzPercentage<=100}get currentIndex(){return this._currentIndex}set currentIndex(e){this._currentIndex=e,this.isCustomStatus||(this._status=e>this.index?"finish":e===this.index?this.outStatus||"":"wait")}ngOnInit(){this.ngZone.runOutsideAngular(()=>(0,X.R)(this.itemContainer.nativeElement,"click").pipe((0,et.h)(()=>this.clickable&&this.currentIndex!==this.index&&!this.nzDisabled),(0,k.R)(this.destroy$)).subscribe(()=>{this.clickOutsideAngular$.next(this.index)}))}enable(){this.nzDisabled=!1,this.cdr.markForCheck()}disable(){this.nzDisabled=!0,this.cdr.markForCheck()}markForCheck(){this.cdr.markForCheck()}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.sBO),t.Y36(t.R0b),t.Y36(I.kn))},n.\u0275cmp=t.Xpm({type:n,selectors:[["nz-step"]],viewQuery:function(e,i){if(1&e&&(t.Gf(ot,5),t.Gf(rt,7)),2&e){let r;t.iGM(r=t.CRH())&&(i.processDotTemplate=r.first),t.iGM(r=t.CRH())&&(i.itemContainer=r.first)}},hostAttrs:[1,"ant-steps-item"],hostVars:16,hostBindings:function(e,i){2&e&&t.ekj("ant-steps-item-wait","wait"===i.nzStatus)("ant-steps-item-process","process"===i.nzStatus)("ant-steps-item-finish","finish"===i.nzStatus)("ant-steps-item-error","error"===i.nzStatus)("ant-steps-item-active",i.currentIndex===i.index)("ant-steps-item-disabled",i.nzDisabled)("ant-steps-item-custom",!!i.nzIcon)("ant-steps-next-error","error"===i.outStatus&&i.currentIndex===i.index+1)},inputs:{nzTitle:"nzTitle",nzSubtitle:"nzSubtitle",nzDescription:"nzDescription",nzDisabled:"nzDisabled",nzPercentage:"nzPercentage",nzStatus:"nzStatus",nzIcon:"nzIcon"},exportAs:["nzStep"],features:[t._Bn([I.kn])],decls:12,vars:8,consts:[[1,"ant-steps-item-container",3,"tabindex"],["itemContainer",""],["class","ant-steps-item-tail",4,"ngIf"],[1,"ant-steps-item-icon"],[3,"ngIf"],[1,"ant-steps-item-content"],[1,"ant-steps-item-title"],[4,"nzStringTemplateOutlet"],["class","ant-steps-item-subtitle",4,"ngIf"],[1,"ant-steps-item-description"],[1,"ant-steps-item-tail"],["class","ant-steps-progress-icon",4,"ngIf"],["class","ant-steps-icon",4,"ngIf"],[1,"ant-steps-progress-icon"],["nzType","circle",3,"nzPercent","nzWidth","nzFormat","nzStrokeWidth"],[1,"ant-steps-icon"],["nz-icon","","nzType","check"],["nz-icon","","nzType","close"],["nz-icon","",3,"nzType","ngClass"],["processDotTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ant-steps-icon-dot"],[1,"ant-steps-item-subtitle"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0,1),t.YNc(2,st,1,0,"div",2),t.TgZ(3,"div",3),t.YNc(4,dt,5,5,"ng-template",4),t.YNc(5,_t,4,6,"ng-template",4),t.qZA(),t.TgZ(6,"div",5)(7,"div",6),t.YNc(8,zt,2,1,"ng-container",7),t.YNc(9,xt,2,1,"div",8),t.qZA(),t.TgZ(10,"div",9),t.YNc(11,Ct,2,1,"ng-container",7),t.qZA()()()),2&e&&(t.Q6J("tabindex",i.clickable&&!i.nzDisabled?0:null),t.uIk("role",i.clickable&&!i.nzDisabled?"button":null),t.xp6(2),t.Q6J("ngIf",!0!==i.last),t.xp6(2),t.Q6J("ngIf",!i.showProcessDot),t.xp6(1),t.Q6J("ngIf",i.showProcessDot),t.xp6(3),t.Q6J("nzStringTemplateOutlet",i.nzTitle),t.xp6(1),t.Q6J("ngIf",i.nzSubtitle),t.xp6(2),t.Q6J("nzStringTemplateOutlet",i.nzDescription))},directives:[L.M,h.O5,P.Ls,J.f,h.mk,h.tP],encapsulation:2,changeDetection:0}),(0,it.gn)([(0,q.yF)()],n.prototype,"nzDisabled",void 0),n})(),bt=(()=>{class n{constructor(e,i,r,a,c,p){this.ngZone=e,this.elementRef=i,this.renderer=r,this.cdr=a,this.directionality=c,this.destroy$=p,this.nzCurrent=0,this.nzDirection="horizontal",this.nzLabelPlacement="horizontal",this.nzType="default",this.nzSize="default",this.nzStartIndex=0,this.nzStatus="process",this.nzIndexChange=new t.vpe,this.indexChangeSubscription=K.w0.EMPTY,this.showProcessDot=!1,this.classMap={},this.dir="ltr",this.setClassMap()}set nzProgressDot(e){e instanceof t.Rgc?(this.showProcessDot=!0,this.customProcessDotTemplate=e):this.showProcessDot=(0,q.sw)(e),this.updateChildrenSteps()}ngOnChanges(e){(e.nzStartIndex||e.nzDirection||e.nzStatus||e.nzCurrent)&&this.updateChildrenSteps(),(e.nzDirection||e.nzProgressDot||e.nzLabelPlacement||e.nzSize)&&this.setClassMap()}ngOnInit(){var e;null===(e=this.directionality.change)||void 0===e||e.pipe((0,k.R)(this.destroy$)).subscribe(i=>{this.dir=i,this.setClassMap(),this.cdr.detectChanges()}),this.dir=this.directionality.value,this.setClassMap(),this.updateChildrenSteps()}ngAfterContentInit(){this.steps&&this.steps.changes.pipe((0,nt.O)(null),(0,k.R)(this.destroy$)).subscribe(()=>{this.updateHostProgressClass(),this.updateChildrenSteps()})}updateHostProgressClass(){if(this.steps&&!this.showProcessDot){const e=!!this.steps.toArray().find(a=>null!==a.nzPercentage),i="ant-steps-with-progress",r=this.elementRef.nativeElement.classList.contains(i);e&&!r?this.renderer.addClass(this.elementRef.nativeElement,i):!e&&r&&this.renderer.removeClass(this.elementRef.nativeElement,i)}}updateChildrenSteps(){if(this.steps){const e=this.steps.length;this.steps.toArray().forEach((i,r)=>{Promise.resolve().then(()=>{i.outStatus=this.nzStatus,i.showProcessDot=this.showProcessDot,this.customProcessDotTemplate&&(i.customProcessTemplate=this.customProcessDotTemplate),i.clickable=this.nzIndexChange.observers.length>0,i.direction=this.nzDirection,i.index=r+this.nzStartIndex,i.currentIndex=this.nzCurrent,i.last=e===r+1,i.markForCheck()})}),this.indexChangeSubscription.unsubscribe(),this.indexChangeSubscription=(0,tt.T)(...this.steps.map(i=>i.clickOutsideAngular$)).pipe((0,k.R)(this.destroy$)).subscribe(i=>{this.nzIndexChange.observers.length&&this.ngZone.run(()=>this.nzIndexChange.emit(i))})}}setClassMap(){this.classMap={[`ant-steps-${this.nzDirection}`]:!0,"ant-steps-label-horizontal":"horizontal"===this.nzDirection,"ant-steps-label-vertical":(this.showProcessDot||"vertical"===this.nzLabelPlacement)&&"horizontal"===this.nzDirection,"ant-steps-dot":this.showProcessDot,"ant-steps-small":"small"===this.nzSize,"ant-steps-navigation":"navigation"===this.nzType,"ant-steps-rtl":"rtl"===this.dir}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.R0b),t.Y36(t.SBq),t.Y36(t.Qsj),t.Y36(t.sBO),t.Y36(Y.Is,8),t.Y36(I.kn))},n.\u0275cmp=t.Xpm({type:n,selectors:[["nz-steps"]],contentQueries:function(e,i,r){if(1&e&&t.Suo(r,Q,4),2&e){let a;t.iGM(a=t.CRH())&&(i.steps=a)}},inputs:{nzCurrent:"nzCurrent",nzDirection:"nzDirection",nzLabelPlacement:"nzLabelPlacement",nzType:"nzType",nzSize:"nzSize",nzStartIndex:"nzStartIndex",nzStatus:"nzStatus",nzProgressDot:"nzProgressDot"},outputs:{nzIndexChange:"nzIndexChange"},exportAs:["nzSteps"],features:[t._Bn([I.kn]),t.TTD],ngContentSelectors:yt,decls:2,vars:1,consts:[[1,"ant-steps",3,"ngClass"]],template:function(e,i){1&e&&(t.F$t(),t.TgZ(0,"div",0),t.Hsn(1),t.qZA()),2&e&&t.Q6J("ngClass",i.classMap)},directives:[h.mk],encapsulation:2,changeDetection:0}),n})(),Tt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[Y.vT,h.ez,P.PV,J.T,L.W]]}),n})();var Z=l(5790),s=l(2382),m=l(5617),U=l(7957),w=l(5860),A=l(9727),N=l(9057),d=l(4546),St=l(1457),_=l(1894),C=l(2683),f=l(1047),y=l(6042),b=l(2643);function Zt(n,o){1&n&&(t.TgZ(0,"div"),t._uU(1,"\u7ed1\u5b9a"),t.qZA())}function wt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){return t.CHM(e),t.oxw().sendOtpCode()}),t._uU(1),t.ALo(2,"i18n"),t.qZA()}if(2&n){const e=t.oxw();t.Q6J("disabled",e.count>0)("nzLoading",e.loading),t.xp6(1),t.hij(" ",e.count?e.count+"s":t.lcZ(2,3,"app.register.get-verification-code")," ")}}function At(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"button",12),t.NdJ("click",function(r){return t.CHM(e),t.oxw().onClose(r)}),t._uU(2),t.ALo(3,"i18n"),t.qZA(),t.TgZ(4,"button",13),t.NdJ("click",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t._uU(5),t.ALo(6,"i18n"),t.qZA()()}2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,2,"mxk.text.close")),t.xp6(3),t.Oqu(t.lcZ(6,4,"mxk.text.submit")))}l(7758);let F=(()=>{class n{constructor(e,i,r,a,c,p,g,v){this.modalRef=e,this.fb=i,this.authnService=r,this.msg=a,this.socialsProviderService=c,this.i18n=p,this.reuseTabService=g,this.cdr=v,this.loading=!1,this.count=0,this.formGroup=new s.cw({})}ngOnInit(){this.formGroup=this.fb.group({telephone:[null,[s.kI.required]],verificationCode:[null,[s.kI.required]]}),console.log("bind open form : ",this.provider,this.socialUserId)}onClose(e){e.preventDefault(),this.modalRef.destroy({refresh:!1})}onSubmit(e){var i,r;if(console.log("this.formGroup.valid",this.formGroup.valid),this.formGroup.valid){let a={username:this.socialUserId,mobile:null===(i=this.formGroup.get("telephone"))||void 0===i?void 0:i.value,code:null===(r=this.formGroup.get("verificationCode"))||void 0===r?void 0:r.value,authType:this.provider};this.authnService.bindSocialsUser(a).subscribe(c=>{0===c.code?(this.reuseTabService.clear(),this.authnService.auth(c.data),this.authnService.navigate({})):this.msg.error("\u7ed1\u5b9a\u5931\u8d25")})}else Object.values(this.formGroup.controls).forEach(a=>{a.invalid&&(a.markAsDirty(),a.updateValueAndValidity({onlySelf:!0}))});e.preventDefault()}sendOtpCode(){var e;this.authnService.produceOtp({mobile:null===(e=this.formGroup.get("telephone"))||void 0===e?void 0:e.value}).subscribe(i=>{0!==i.code?this.msg.error("\u53d1\u9001\u5931\u8d25"):this.msg.success("\u53d1\u9001\u6210\u529f")}),this.count=59,this.interval$=setInterval(()=>{this.count-=1,this.count<=0&&clearInterval(this.interval$),this.cdr.detectChanges()},1e3)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(U.Lf),t.Y36(s.qu),t.Y36(w.p),t.Y36(A.dD),t.Y36(N.b),t.Y36(m.Oi),t.Y36(Z.Wu),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-socials-provider-binduser"]],inputs:{socialUserId:"socialUserId",provider:"provider"},decls:16,vars:8,consts:[[4,"nzModalTitle"],["nz-form","","se-container","1",3,"formGroup","ngSubmit"],[2,"width","100%"],["nzErrorTip","Please input your telephone!"],["nzSize","large","nzPrefixIcon","user"],["nz-input","","formControlName","telephone",3,"placeholder"],["nzErrorTip","Please input your verification code!"],["nzSize","large","nzPrefixIcon","mail","nzSearch","",3,"nzAddOnAfter"],["nz-input","","formControlName","verificationCode",3,"placeholder"],["suffixSendOtpCodeButton",""],[4,"nzModalFooter"],["type","button","nz-button","","nzSize","large","nzBlock","",3,"disabled","nzLoading","click"],["nz-button","","nzType","default",3,"click"],["nz-button","","nzType","primary",3,"click"]],template:function(e,i){if(1&e&&(t.YNc(0,Zt,2,0,"div",0),t.TgZ(1,"div")(2,"form",1),t.NdJ("ngSubmit",function(a){return i.onSubmit(a)}),t.TgZ(3,"nz-form-item",2)(4,"nz-form-control",3)(5,"nz-input-group",4),t._UZ(6,"input",5),t.ALo(7,"i18n"),t.qZA()()(),t.TgZ(8,"nz-form-item",2)(9,"nz-form-control",6)(10,"nz-input-group",7),t._UZ(11,"input",8),t.ALo(12,"i18n"),t.qZA(),t.YNc(13,wt,3,5,"ng-template",null,9,t.W1O),t.qZA()()()(),t.YNc(15,At,7,6,"div",10)),2&e){const r=t.MAs(14);t.xp6(2),t.Q6J("formGroup",i.formGroup),t.xp6(4),t.s9C("placeholder",t.lcZ(7,4,"mxk.login.text.mobile")),t.xp6(4),t.Q6J("nzAddOnAfter",r),t.xp6(1),t.s9C("placeholder",t.lcZ(12,6,"mxk.login.text.captcha"))}},directives:[U.h1,s._Y,s.JL,d.Lr,St.nV,s.sg,_.SK,d.Nx,_.t3,d.Fd,C.w,f.gB,f.Zp,s.Fj,s.JJ,s.u,y.ix,b.dQ,U.Uh],pipes:[m.Ck],styles:["","nz-form-item[_ngcontent-%COMP%]{width:100%}"]}),n})();var u=l(4521);let D=(()=>{class n{constructor(e,i,r,a,c,p,g,v){this.viewContainerRef=e,this.modalService=i,this.router=r,this.socialsProviderService=a,this.settingsService=c,this.authnService=p,this.reuseTabService=g,this.route=v,this.provider=""}ngOnInit(){this.provider=this.route.snapshot.params.provider,this.settingsService.user.name?this.socialsProviderService.bind(this.provider,this.route.snapshot.queryParams).subscribe(e=>{this.router.navigateByUrl("/config/socialsassociate")}):this.socialsProviderService.callback(this.provider,this.route.snapshot.queryParams).subscribe(e=>{if(0===e.code)this.reuseTabService.clear(),this.authnService.auth(e.data);else if(102===e.code)return void this.openBindUser(e.message);this.authnService.navigate({})})}openBindUser(e){console.log("bind user : ",this.provider,e),this.modalService.create({nzContent:F,nzViewContainerRef:this.viewContainerRef,nzComponentParams:{socialUserId:e,provider:this.provider},nzOnOk:()=>new Promise(r=>setTimeout(r,1e3))}).afterClose.subscribe(r=>{})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(t.s_b),t.Y36(U.Sf),t.Y36(u.F0),t.Y36(N.b),t.Y36(m.gb),t.Y36(w.p),t.Y36(Z.Wu,8),t.Y36(u.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-callback"]],decls:0,vars:0,template:function(e,i){},encapsulation:2}),n})();var E=l(54),kt=l(6699);let R=(()=>{class n{constructor(e,i,r,a){this.tokenService=i,this.settings=r,this.router=a,this.f=e.group({password:[null,s.kI.required]})}get user(){return this.settings.user}submit(){for(const e in this.f.controls)this.f.controls[e].markAsDirty(),this.f.controls[e].updateValueAndValidity();this.f.valid&&(console.log("Valid!"),console.log(this.f.value),this.tokenService.set({token:"123"}),this.router.navigate(["dashboard"]))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(E.T),t.Y36(m.gb),t.Y36(u.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-lock"]],decls:15,vars:11,consts:[[1,"ant-card","width-lg",2,"margin","0 auto"],[1,"ant-card-body"],[1,"avatar"],["nzIcon","user","nzSize","large",3,"nzSrc"],["nz-form","","role","form",1,"mt-md",3,"formGroup","ngSubmit"],[3,"nzErrorTip"],["nzSuffixIcon","lock"],["type","password","nz-input","","formControlName","password"],["nzType","flex","nzAlign","middle"],[2,"text-align","right",3,"nzOffset","nzSpan"],["nz-button","","nzType","primary",3,"disabled"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"nz-avatar",3),t.qZA(),t.TgZ(4,"form",4),t.NdJ("ngSubmit",function(){return i.submit()}),t.TgZ(5,"nz-form-item")(6,"nz-form-control",5),t.ALo(7,"i18n"),t.TgZ(8,"nz-input-group",6),t._UZ(9,"input",7),t.qZA()()(),t.TgZ(10,"nz-row",8)(11,"nz-col",9)(12,"button",10),t._uU(13),t.ALo(14,"i18n"),t.qZA()()()()()()),2&e&&(t.xp6(3),t.Q6J("nzSrc",i.user.avatar),t.xp6(1),t.Q6J("formGroup",i.f),t.xp6(2),t.Q6J("nzErrorTip",t.lcZ(7,7,"validation.password.required")),t.xp6(5),t.Q6J("nzOffset",12)("nzSpan",12),t.xp6(1),t.Q6J("disabled",!i.f.valid),t.xp6(1),t.Oqu(t.lcZ(14,9,"app.lock")))},directives:[kt.Dz,s._Y,s.JL,d.Lr,s.sg,_.SK,d.Nx,_.t3,d.Fd,C.w,f.gB,f.Zp,s.Fj,s.JJ,s.u,y.ix,b.dQ],pipes:[m.Ck],styles:["[_nghost-%COMP%]     .ant-card-body{position:relative;margin-top:80px}[_nghost-%COMP%]     .avatar{position:absolute;top:-20px;left:50%;margin-left:-20px}"]}),n})();var T=l(8746),z=l(379);let B=(()=>{class n{constructor(e){this.http=e}captcha(e){return this.http.get("/captcha?_allow_anonymous=true",e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(m.lP))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var S=l(3868),O=l(2359),It=l(6114),Pt=l(404);const Ut=function(){return{standalone:!0}};function Lt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"nz-radio-group",5),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().loginType=r}),t.TgZ(1,"label",6),t._UZ(2,"i",7),t._uU(3),t.ALo(4,"i18n"),t.qZA(),t.TgZ(5,"label",8),t._UZ(6,"i",9),t._uU(7),t.ALo(8,"i18n"),t.qZA(),t.TgZ(9,"label",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().getQrCode()}),t._UZ(10,"i",11),t._uU(11),t.ALo(12,"i18n"),t.qZA()()}if(2&n){const e=t.oxw();t.Q6J("ngModel",e.loginType)("ngModelOptions",t.DdM(11,Ut)),t.xp6(3),t.hij(" ",t.lcZ(4,5,"mxk.login.tab-credentials")," "),t.xp6(4),t.hij(" ",t.lcZ(8,7,"mxk.login.tab-mobile")," "),t.xp6(4),t.hij("",t.lcZ(12,9,"mxk.login.tab-qrscan")," ")}}function Nt(n,o){if(1&n&&t._UZ(0,"nz-alert",22),2&n){const e=t.oxw(2);t.Q6J("nzType","error")("nzMessage",e.error)("nzShowIcon",!0)}}function Ot(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"i",23),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return r.passwordVisible=!r.passwordVisible}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("nzType",e.passwordVisible?"eye-invisible":"eye")}}function Mt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"img",27),t.NdJ("click",function(){return t.CHM(e),t.oxw(3).getImageCaptcha()}),t.qZA()}if(2&n){const e=t.oxw(3);t.s9C("src",e.imageCaptcha,t.LSH)}}function qt(n,o){if(1&n&&(t.TgZ(0,"nz-form-item",14)(1,"nz-form-control",15)(2,"nz-input-group",24),t._UZ(3,"input",25),t.ALo(4,"i18n"),t.qZA(),t.YNc(5,Mt,1,1,"ng-template",null,26,t.W1O),t.qZA()()),2&n){const e=t.MAs(6);t.xp6(2),t.Q6J("nzAddOnAfter",e),t.xp6(1),t.s9C("placeholder",t.lcZ(4,2,"mxk.login.text.captcha"))}}function Jt(n,o){if(1&n&&(t.TgZ(0,"div",12),t.YNc(1,Nt,1,3,"nz-alert",13),t.TgZ(2,"nz-form-item",14)(3,"nz-form-control",15)(4,"nz-input-group",16),t._UZ(5,"input",17),t.ALo(6,"i18n"),t.qZA()()(),t.TgZ(7,"nz-form-item",14)(8,"nz-form-control",15)(9,"nz-input-group",18),t._UZ(10,"input",19),t.ALo(11,"i18n"),t.qZA(),t.YNc(12,Ot,1,1,"ng-template",null,20,t.W1O),t.qZA()(),t.YNc(14,qt,7,4,"nz-form-item",21),t.qZA()),2&n){const e=t.MAs(13),i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.error),t.xp6(4),t.s9C("placeholder",t.lcZ(6,6,"mxk.login.text.username")),t.xp6(4),t.Q6J("nzSuffix",e),t.xp6(1),t.s9C("placeholder",t.lcZ(11,8,"mxk.login.text.password")),t.Q6J("type",i.passwordVisible?"text":"password"),t.xp6(4),t.Q6J("ngIf","NONE"!=i.captchaType)}}function Yt(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"validation.phone-number.required")," "))}function Qt(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"validation.phone-number.wrong-format")," "))}function Ft(n,o){if(1&n&&(t.YNc(0,Yt,3,3,"ng-container",3),t.YNc(1,Qt,3,3,"ng-container",3)),2&n){const e=o.$implicit;t.Q6J("ngIf",e.errors.required),t.xp6(1),t.Q6J("ngIf",e.errors.pattern)}}function Dt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",34),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sendOtpCode()}),t._uU(1),t.ALo(2,"i18n"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",e.count>0)("nzLoading",e.loading),t.xp6(1),t.hij(" ",e.count?e.count+"s":t.lcZ(2,3,"app.register.get-verification-code")," ")}}function Et(n,o){if(1&n&&(t.TgZ(0,"div",12)(1,"nz-form-item",14)(2,"nz-form-control",28)(3,"nz-input-group",16),t._UZ(4,"input",29),t.ALo(5,"i18n"),t.qZA(),t.YNc(6,Ft,2,2,"ng-template",null,30,t.W1O),t.qZA()(),t.TgZ(8,"nz-form-item",14)(9,"nz-form-control",28),t.ALo(10,"i18n"),t.TgZ(11,"nz-input-group",31),t._UZ(12,"input",32),t.ALo(13,"i18n"),t.qZA(),t.YNc(14,Dt,3,5,"ng-template",null,33,t.W1O),t.qZA()()()),2&n){const e=t.MAs(15);t.xp6(4),t.s9C("placeholder",t.lcZ(5,4,"mxk.login.text.mobile")),t.xp6(5),t.Q6J("nzErrorTip",t.lcZ(10,6,"")),t.xp6(2),t.Q6J("nzAddOnAfter",e),t.xp6(1),t.s9C("placeholder",t.lcZ(13,8,"mxk.login.text.captcha"))}}function Rt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",37),t._uU(1," \u4e8c\u7ef4\u7801\u8fc7\u671f "),t.TgZ(2,"a",38),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).getQrCode()}),t._uU(3,"\u5237\u65b0"),t.qZA()()}}function Bt(n,o){if(1&n&&(t.TgZ(0,"div",12),t._UZ(1,"div",35),t.YNc(2,Rt,4,0,"div",36),t.qZA()),2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.qrexpire)}}function Vt(n,o){1&n&&(t.TgZ(0,"nz-form-item")(1,"nz-col",39)(2,"label",40),t._uU(3),t.ALo(4,"i18n"),t.qZA()(),t.TgZ(5,"nz-col",41)(6,"a",42),t._uU(7),t.ALo(8,"i18n"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("nzSpan",12),t.xp6(2),t.Oqu(t.lcZ(4,4,"mxk.login.remember-me")),t.xp6(2),t.Q6J("nzSpan",12),t.xp6(2),t.Oqu(t.lcZ(8,6,"mxk.login.forgot-password")))}function $t(n,o){if(1&n&&(t.TgZ(0,"nz-form-item")(1,"button",43),t._uU(2),t.ALo(3,"i18n"),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("nzLoading",e.loading),t.xp6(1),t.hij(" ",t.lcZ(3,2,"app.login.login")," ")}}function Gt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"i",47),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).socialauth(a.provider)}),t._UZ(2,"img",48),t.qZA(),t.BQk()}if(2&n){const e=o.$implicit;t.xp6(1),t.s9C("nzTooltipTitle",e.providerName),t.xp6(1),t.s9C("src",e.icon,t.LSH)}}function jt(n,o){if(1&n&&(t.TgZ(0,"div",44),t._uU(1),t.ALo(2,"i18n"),t.YNc(3,Gt,3,2,"ng-container",45),t.TgZ(4,"a",46),t._uU(5),t.ALo(6,"i18n"),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.lcZ(2,3,"app.login.sign-in-with")," "),t.xp6(2),t.Q6J("ngForOf",e.socials.providers),t.xp6(2),t.Oqu(t.lcZ(6,5,"mxk.login.signup"))}}let V=(()=>{class n{constructor(e,i,r,a,c,p,g,v,x,qe){this.router=i,this.settingsService=r,this.authnService=a,this.socialsProviderService=c,this.imageCaptchaService=p,this.reuseTabService=g,this.route=v,this.msg=x,this.cdr=qe,this.socials={providers:[],qrScan:""},this.error="",this.switchTab=!0,this.loginType="normal",this.loading=!1,this.passwordVisible=!1,this.qrexpire=!1,this.imageCaptcha="",this.captchaType="",this.state="",this.count=0,this.form=e.group({userName:[null,[s.kI.required]],password:[null,[s.kI.required]],captcha:[null,[s.kI.required]],mobile:[null,[s.kI.required,s.kI.pattern(/^1\d{10}$/)]],otpCaptcha:[null,[s.kI.required]],remember:[!1]})}ngOnInit(){this.route.snapshot.queryParams[z.z.REDIRECT_URI]&&this.authnService.setRedirectUri(this.route.snapshot.queryParams[z.z.REDIRECT_URI]),this.route.snapshot.queryParams[z.z.CONGRESS]&&this.congressLogin(this.route.snapshot.queryParams[z.z.CONGRESS]),this.authnService.clear(),this.authnService.get({remember_me:localStorage.getItem(z.z.REMEMBER)}).pipe((0,T.x)(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(e=>{var i;this.loading=!0,0!==e.code?this.error=e.msg:e.data.token?(this.reuseTabService.clear(),this.authnService.auth(e.data),this.authnService.navigate({})):(this.socials=e.data.socials,this.state=e.data.state,this.captchaType=e.data.captcha,"NONE"===this.captchaType?null===(i=this.form.get("captcha"))||void 0===i||i.clearValidators():this.imageCaptchaService.captcha({state:this.state,captcha:this.captchaType}).subscribe(r=>{this.imageCaptcha=r.data.image,this.cdr.detectChanges()}))}),this.cdr.detectChanges()}congressLogin(e){this.authnService.congress({congress:e}).pipe((0,T.x)(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(i=>{this.loading=!0,0!==i.code?this.error=i.msg:(this.reuseTabService.clear(),this.authnService.auth(i.data),this.authnService.navigate({}))})}get userName(){return this.form.get("userName")}get password(){return this.form.get("password")}get mobile(){return this.form.get("mobile")}get captcha(){return this.form.get("captcha")}get otpCaptcha(){return this.form.get("otpCaptcha")}get remember(){return this.form.get("remember")}getImageCaptcha(){this.imageCaptchaService.captcha({state:this.state,captcha:this.captchaType}).subscribe(e=>{this.imageCaptcha=e.data.image,this.cdr.detectChanges()})}sendOtpCode(){if(this.mobile.invalid)return this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0});this.authnService.produceOtp({mobile:this.mobile.value}).subscribe(e=>{0!==e.code&&this.msg.success("\u53d1\u9001\u5931\u8d25")}),this.count=59,this.interval$=setInterval(()=>{this.count-=1,this.count<=0&&clearInterval(this.interval$),this.cdr.detectChanges()},1e3)}submit(){var e;if(this.error="","normal"===this.loginType){if(this.userName.markAsDirty(),this.userName.updateValueAndValidity(),this.password.markAsDirty(),this.password.updateValueAndValidity(),this.captcha.markAsDirty(),this.captcha.updateValueAndValidity(),this.userName.invalid||this.password.invalid||this.captcha.invalid)return}else if(this.mobile.markAsDirty(),this.mobile.updateValueAndValidity(),this.otpCaptcha.markAsDirty(),this.otpCaptcha.updateValueAndValidity(),this.mobile.invalid||this.otpCaptcha.invalid)return;localStorage.setItem(z.z.REMEMBER,null===(e=this.form.get(z.z.REMEMBER))||void 0===e?void 0:e.value),this.loading=!0,this.cdr.detectChanges(),this.authnService.login({authType:this.loginType,state:this.state,username:this.userName.value,password:this.password.value,captcha:this.captcha.value,mobile:this.mobile.value,otpCaptcha:this.otpCaptcha.value,remeberMe:this.remember.value}).pipe((0,T.x)(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(i=>{this.loading=!0,0!==i.code?(this.error=i.message,"normal"===this.loginType&&this.getImageCaptcha()):(this.reuseTabService.clear(),this.authnService.auth(i.data),this.authnService.navigate({})),this.cdr.detectChanges()})}socialauth(e){this.authnService.clearUser(),this.socialsProviderService.authorize(e).subscribe(i=>{window.location.href=i.data})}getQrCode(){this.qrexpire=!1,this.interval$&&clearInterval(this.interval$),this.authnService.clearUser(),this.socialsProviderService.scanqrcode(this.socials.qrScan).subscribe(e=>{0===e.code&&("workweixin"===this.socials.qrScan?this.qrScanWorkweixin(e.data):"dingtalk"===this.socials.qrScan?this.qrScanDingtalk(e.data):"maxkey"===this.socials.qrScan?this.qrScanMaxkey(e.data):"feishu"===this.socials.qrScan&&this.qrScanFeishu(e.data))})}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}qrScanWorkweixin(e){new WwLogin({id:"div_qrcodelogin",appid:e.clientId,agentid:e.agentId,redirect_uri:encodeURIComponent(e.redirectUri),state:e.state,href:"data:text/css;base64,LmltcG93ZXJCb3ggLnFyY29kZSB7d2lkdGg6IDI1MHB4O30NCi5pbXBvd2VyQm94IC50aXRsZSB7ZGlzcGxheTogbm9uZTt9DQouaW1wb3dlckJveCAuaW5mbyB7d2lkdGg6IDI1MHB4O30NCi5zdGF0dXNfaWNvbiB7ZGlzcGxheTpub25lfQ0KLmltcG93ZXJCb3ggLnN0YXR1cyB7dGV4dC1hbGlnbjogY2VudGVyO30="})}qrScanFeishu(e){var i=document.querySelector("#div_qrcodelogin");null==i||i.childNodes.forEach(function(a,c,p){null==i||i.removeChild(a)}),fsredirectUri=`https://passport.feishu.cn/suite/passport/oauth/authorize?client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectUri)}&response_type=code&state=${e.state}`;var r=fsredirectUri;QRLoginObj=QRLogin({id:"div_qrcodelogin",goto:r,width:"300",height:"300",style:"border: 0;"})}qrScanDingtalk(e){var i=encodeURIComponent(e.redirectUri),r=encodeURIComponent(`https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid=${e.clientId}&response_type=code&scope=snsapi_login&state=${e.state}&redirect_uri=${i}`);ddredirect_uri=`https://oapi.dingtalk.com/connect/oauth2/sns_authorize?appid=${e.clientId}&response_type=code&scope=snsapi_login&state=${e.state}&redirect_uri=${e.redirectUri}`,DDLogin({id:"div_qrcodelogin",goto:r,style:"border:none;background-color:#FFFFFF;",width:"360",height:"400"})}qrScanMaxkey(e){document.getElementById("div_qrcodelogin").innerHTML="",new QRCode("div_qrcodelogin",{width:200,height:200,colorDark:"#000000",colorLight:"#ffffff"}).makeCode(e.state),this.count=90,this.interval$=setInterval(()=>{this.count-=1,"qrscan"!=this.loginType&&clearInterval(this.interval$),this.count<=0&&clearInterval(this.interval$),this.socialsProviderService.qrcallback(this.socials.qrScan,e.state).subscribe(r=>{0===r.code?(this.reuseTabService.clear(),this.authnService.auth(r.data),this.authnService.navigate({}),clearInterval(this.interval$)):102===r.code&&(clearInterval(this.interval$),this.qrexpire=!0,this.cdr.detectChanges())}),this.cdr.detectChanges()},2e3)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(u.F0),t.Y36(m.gb),t.Y36(w.p),t.Y36(N.b),t.Y36(B),t.Y36(Z.Wu,8),t.Y36(u.gz),t.Y36(A.dD),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-login"]],decls:8,vars:8,consts:[["nz-form","","role","form",3,"formGroup","ngSubmit"],["nzSize","large","style","margin-bottom: 8px; width: 100%",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],["nz-row","",4,"ngIf"],[4,"ngIf"],["class","other",4,"ngIf"],["nzSize","large",2,"margin-bottom","8px","width","100%",3,"ngModel","ngModelOptions","ngModelChange"],["nz-radio-button","","nzValue","normal",2,"width","50%","text-align","center"],["nz-icon","","nzType","user","nzTheme","outline"],["nz-radio-button","","nzValue","mobile",1,"d-none",2,"width","50%","text-align","center"],["nz-icon","","nzType","mobile","nzTheme","outline"],["nz-radio-button","","nzValue","qrscan",2,"width","50%","text-align","center",3,"click"],["nz-icon","","nzType","qrcode","nzTheme","outline"],["nz-row",""],["style","width: 100%","class","mb-lg",3,"nzType","nzMessage","nzShowIcon",4,"ngIf"],[2,"width","100%"],["nzErrorTip",""],["nzSize","large","nzPrefixIcon","user"],["nz-input","","formControlName","userName",3,"placeholder"],["nzSize","large","nzPrefixIcon","key",3,"nzSuffix"],["nz-input","","formControlName","password",3,"type","placeholder"],["suffixTemplate",""],["style","width: 100%",4,"ngIf"],[1,"mb-lg",2,"width","100%",3,"nzType","nzMessage","nzShowIcon"],["nz-icon","",3,"nzType","click"],["nzSearch","","nzSize","large","nzPrefixIcon","lock","nzSearch","",3,"nzAddOnAfter"],["type","text","formControlName","captcha","nz-input","",3,"placeholder"],["suffixImageCaptchaButton",""],[3,"src","click"],[3,"nzErrorTip"],["nz-input","","formControlName","mobile",3,"placeholder"],["mobileErrorTip",""],["nzSize","large","nzPrefixIcon","mail","nzSearch","",3,"nzAddOnAfter"],["nz-input","","formControlName","otpCaptcha",3,"placeholder"],["suffixSendOtpCodeButton",""],["type","button","nz-button","","nzSize","large","nzBlock","",3,"disabled","nzLoading","click"],["id","div_qrcodelogin",1,"qrcode",2,"background","#fff","padding","20px"],["id","qrexpire","style","width: 100%;text-align: center;background: #fff;padding-bottom: 20px;",4,"ngIf"],["id","qrexpire",2,"width","100%","text-align","center","background","#fff","padding-bottom","20px"],["href","javascript:",3,"click"],[3,"nzSpan"],["nz-checkbox","","formControlName","remember"],[1,"text-right",3,"nzSpan"],["routerLink","/passport/forgot",1,"forgot"],["nz-button","","type","submit","nzType","primary","nzSize","large","nzBlock","",3,"nzLoading"],[1,"other"],[4,"ngFor","ngForOf"],["routerLink","/passport/register",1,"register","d-none"],["nz-tooltip","","nz-icon","",1,"icon",3,"nzTooltipTitle","click"],[2,"width","32px",3,"src"]],template:function(e,i){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return i.submit()}),t.YNc(1,Lt,13,12,"nz-radio-group",1),t.YNc(2,Jt,15,10,"div",2),t.YNc(3,Et,16,10,"div",2),t.YNc(4,Bt,3,1,"div",2),t.YNc(5,Vt,9,8,"nz-form-item",3),t.YNc(6,$t,4,4,"nz-form-item",3),t.qZA(),t.YNc(7,jt,7,7,"div",4)),2&e&&(t.Q6J("formGroup",i.form),t.xp6(1),t.Q6J("ngIf",i.switchTab),t.xp6(1),t.Q6J("ngIf","normal"==i.loginType),t.xp6(1),t.Q6J("ngIf","mobile"==i.loginType),t.xp6(1),t.Q6J("ngIf","qrscan"==i.loginType),t.xp6(1),t.Q6J("ngIf","normal"==i.loginType||"mobile"==i.loginType),t.xp6(1),t.Q6J("ngIf","normal"==i.loginType||"mobile"==i.loginType),t.xp6(1),t.Q6J("ngIf","normal"==i.loginType))},directives:[s._Y,s.JL,d.Lr,s.sg,h.O5,S.Dg,s.JJ,s.On,S.Of,S.Bq,C.w,P.Ls,_.SK,O.r,d.Nx,_.t3,d.Fd,f.gB,f.Zp,s.Fj,s.u,f.ke,y.ix,b.dQ,It.Ie,u.yS,h.sg,Pt.SY],pipes:[m.Ck],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     .ant-tabs .ant-tabs-bar{margin-bottom:24px;text-align:center;border-bottom:0}[_nghost-%COMP%]     .ant-tabs-tab{font-size:16px;line-height:24px}[_nghost-%COMP%]     .ant-input-affix-wrapper .ant-input:not(:first-child){padding-left:4px}[_nghost-%COMP%]     .login-tab{color:#000;background:unset;border-color:unset;border-right-color:unset}[_nghost-%COMP%]     .icon{margin-left:16px;color:#0003;font-size:24px;vertical-align:middle;cursor:pointer;transition:color .3s}[_nghost-%COMP%]     .icon:hover{color:#1890ff}[_nghost-%COMP%]     .other{margin-top:24px;line-height:22px;text-align:left}[_nghost-%COMP%]     .other nz-tooltip{vertical-align:middle}[_nghost-%COMP%]     .other .register{float:right}[data-theme=dark]   [_nghost-%COMP%]     .icon{color:#fff3}[data-theme=dark]   [_nghost-%COMP%]     .icon:hover{color:#fff}input[_ngcontent-%COMP%]{font-weight:700}.qrcode[_ngcontent-%COMP%]{width:100%;text-align:center}.qrcode[_ngcontent-%COMP%]   iframe[_ngcontent-%COMP%]{border:0}"],changeDetection:0}),n})();var Wt=l(6260),Ht=l(28);let Xt=(()=>{class n{constructor(e){this.http=e}produceOtp(e){return this.http.get("/forgotpassword/produceOtp?_allow_anonymous=true",e)}produceEmailOtp(e){return this.http.get("/forgotpassword/produceEmailOtp?_allow_anonymous=true",e)}setPassWord(e){return this.http.get("/forgotpassword/setpassword?_allow_anonymous=true",e)}validateCaptcha(e){return this.http.get("/forgotpassword/validateCaptcha?_allow_anonymous=true",e)}passwordpolicy(){return this.http.get("/forgotpassword/passwordpolicy?_allow_anonymous=true",null)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(m.lP))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Kt(n,o){1&n&&(t.TgZ(0,"nz-form-item",1)(1,"nz-form-control",8)(2,"nz-input-group",18),t._UZ(3,"input",19),t.ALo(4,"i18n"),t.qZA()()()),2&n&&(t.xp6(3),t.s9C("placeholder",t.lcZ(4,1,"mxk.forgot.email")))}function te(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"validation.phone-number.required")," "))}function ee(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"validation.phone-number.wrong-format")," "))}function ne(n,o){if(1&n&&(t.YNc(0,te,3,3,"ng-container",23),t.YNc(1,ee,3,3,"ng-container",23)),2&n){const e=o.$implicit;t.Q6J("ngIf",e.errors.required),t.xp6(1),t.Q6J("ngIf",e.errors.pattern)}}function ie(n,o){1&n&&(t.TgZ(0,"nz-form-item",1)(1,"nz-form-control",12)(2,"nz-input-group",20),t._UZ(3,"input",21),t.ALo(4,"i18n"),t.qZA(),t.YNc(5,ne,2,2,"ng-template",null,22,t.W1O),t.qZA()()),2&n&&(t.xp6(3),t.s9C("placeholder",t.lcZ(4,1,"mxk.forgot.mobile")))}function oe(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"img",24),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).getImageCaptcha()}),t.qZA()}if(2&n){const e=t.oxw(2);t.s9C("src",e.imageCaptcha,t.LSH)}}function re(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"button",25),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).sendOtpCode()}),t._uU(1),t.ALo(2,"i18n"),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("disabled",e.count>0)("nzLoading",e.loading),t.xp6(1),t.hij(" ",e.count?e.count+"s":t.lcZ(2,3,"mxk.forgot.sendCaptcha")," ")}}const se=function(){return{standalone:!0}};function ae(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"nz-form-item",1)(1,"nz-form-item",1)(2,"nz-radio-group",6),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().forgotType=r})("ngModelChange",function(){return t.CHM(e),t.oxw().ngModelChange()}),t.TgZ(3,"label",7),t._uU(4),t.ALo(5,"i18n"),t.qZA(),t.TgZ(6,"label",7),t._uU(7),t.ALo(8,"i18n"),t.qZA()()(),t.YNc(9,Kt,5,3,"nz-form-item",4),t.YNc(10,ie,7,3,"nz-form-item",4),t.TgZ(11,"nz-form-item",1)(12,"nz-form-control",8)(13,"nz-input-group",9),t._UZ(14,"input",10),t.ALo(15,"i18n"),t.qZA(),t.YNc(16,oe,1,1,"ng-template",null,11,t.W1O),t.qZA()(),t.TgZ(18,"nz-form-item",1)(19,"nz-form-control",12),t.ALo(20,"i18n"),t.TgZ(21,"nz-input-group",13),t._UZ(22,"input",14),t.ALo(23,"i18n"),t.qZA(),t.YNc(24,re,3,5,"ng-template",null,15,t.W1O),t.qZA()(),t.TgZ(26,"nz-form-item",1)(27,"button",16),t.NdJ("click",function(r){return t.CHM(e),t.oxw().onNextReset(r)}),t._uU(28),t.ALo(29,"i18n"),t.qZA(),t.TgZ(30,"a",17),t._uU(31),t.ALo(32,"i18n"),t.qZA()()()}if(2&n){const e=t.MAs(17),i=t.MAs(25),r=t.oxw();t.xp6(2),t.Q6J("ngModel",r.forgotType)("ngModelOptions",t.DdM(29,se)),t.xp6(1),t.Q6J("nzValue","mobile"),t.xp6(1),t.Oqu(t.lcZ(5,15,"mxk.forgot.type.mobile")),t.xp6(2),t.Q6J("nzValue","email"),t.xp6(1),t.Oqu(t.lcZ(8,17,"mxk.forgot.type.email")),t.xp6(2),t.Q6J("ngIf","email"===r.forgotType),t.xp6(1),t.Q6J("ngIf","mobile"===r.forgotType),t.xp6(3),t.Q6J("nzAddOnAfter",e),t.xp6(1),t.s9C("placeholder",t.lcZ(15,19,"mxk.forgot.captcha")),t.xp6(5),t.Q6J("nzErrorTip",t.lcZ(20,21,"")),t.xp6(2),t.Q6J("nzAddOnAfter",i),t.xp6(1),t.s9C("placeholder",t.lcZ(23,23,"mxk.login.text.captcha")),t.xp6(6),t.hij(" ",t.lcZ(29,25,"mxk.forgot.next")," "),t.xp6(3),t.Oqu(t.lcZ(32,27,"mxk.forgot.login"))}}function le(n,o){if(1&n&&(t.TgZ(0,"li"),t._uU(1),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.Oqu(e)}}function ce(n,o){if(1&n&&(t.TgZ(0,"nz-form-item",26)(1,"h2",1),t._UZ(2,"span",27),t._uU(3),t.ALo(4,"i18n"),t.qZA(),t.TgZ(5,"ul",28),t.YNc(6,le,2,1,"li",29),t.qZA()()),2&n){const e=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,2,"validation.password.conformance-strength")),t.xp6(3),t.Q6J("ngForOf",e.policyMessage)}}function pe(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"i",37),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return r.passwordVisible=!r.passwordVisible}),t.qZA()}if(2&n){const e=t.oxw(2);t.Q6J("nzType",e.passwordVisible?"eye-invisible":"eye")}}function ue(n,o){if(1&n&&t._UZ(0,"nz-alert",38),2&n){const e=t.oxw(2);t.s9C("nzMessage",e.dynamicallyCheckPasswordErrorMsg)}}function me(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"nz-form-item",1)(1,"nz-form-item",1)(2,"nz-form-label",30),t._uU(3),t.ALo(4,"i18n"),t.qZA()(),t.TgZ(5,"nz-form-item",1)(6,"nz-form-control",12),t.ALo(7,"i18n"),t.TgZ(8,"nz-input-group",31)(9,"input",32),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().form.model.password=r})("input",function(){t.CHM(e);const r=t.oxw();return r.dynamicallyCheckPassword(r.form.model.password)}),t.ALo(10,"i18n"),t.qZA()(),t.YNc(11,pe,1,1,"ng-template",null,33,t.W1O),t.YNc(13,ue,1,1,"nz-alert",34),t.qZA()(),t.TgZ(14,"nz-form-item",1)(15,"nz-form-label",35),t._uU(16),t.ALo(17,"i18n"),t.qZA()(),t.TgZ(18,"nz-form-item",1)(19,"nz-form-control",12),t.ALo(20,"i18n"),t.TgZ(21,"input",36),t.NdJ("ngModelChange",function(r){return t.CHM(e),t.oxw().form.model.confirmPassword=r})("input",function(){t.CHM(e);const r=t.oxw();return r.dynamicallyCheckConfirm(r.form.model.confirmPassword)}),t.ALo(22,"i18n"),t.qZA()()(),t.TgZ(23,"nz-form-item",1)(24,"button",16),t.NdJ("click",function(r){return t.CHM(e),t.oxw().onSubmit(r)}),t._uU(25),t.ALo(26,"i18n"),t.qZA(),t.TgZ(27,"a",17),t._uU(28),t.ALo(29,"i18n"),t.qZA()()()}if(2&n){const e=t.MAs(12),i=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,13,"mxk.password.password")),t.xp6(3),t.Q6J("nzErrorTip",t.lcZ(7,15,"validation.password.input")),t.xp6(2),t.Q6J("nzSuffix",e),t.xp6(1),t.s9C("placeholder",t.lcZ(10,17,"validation.password.input")),t.Q6J("type",i.passwordVisible?"text":"password")("ngModel",i.form.model.password),t.xp6(4),t.Q6J("ngIf",""!=i.dynamicallyCheckPasswordErrorMsg),t.xp6(3),t.Oqu(t.lcZ(17,19,"mxk.password.confirmPassword")),t.xp6(3),t.Q6J("nzErrorTip",t.lcZ(20,21,"validation.confirmPassword.input")),t.xp6(2),t.s9C("placeholder",t.lcZ(22,23,"validation.confirmPassword.input")),t.Q6J("ngModel",i.form.model.confirmPassword),t.xp6(4),t.hij(" ",t.lcZ(26,25,"mxk.forgot.submit")," "),t.xp6(3),t.Oqu(t.lcZ(29,27,"mxk.forgot.login"))}}let de=(()=>{class n{constructor(e,i,r,a,c,p,g){this.router=i,this.forgotPasswordService=r,this.imageCaptchaService=a,this.msg=c,this.i18n=p,this.cdr=g,this.form={submitting:!1,model:new Ht.G},this.imageCaptcha="",this.state="",this.step=0,this.forgotType="mobile",this.passwordVisible=!1,this.loading=!1,this.count=0,this.userId="",this.username="",this.policyMessage=[],this.policy={},this.dynamicallyCheckPasswordErrorMsg="",this.formGroup=e.group({mobile:[null,[s.kI.required,s.kI.pattern(/^1\d{10}$/)]],email:[null,[s.kI.required]],password:[null,[s.kI.required]],captcha:[null,[s.kI.required]],otpCaptcha:[null,[s.kI.required]],confirmPassword:[null,[s.kI.required]]})}get email(){return this.formGroup.get("email")}get password(){return this.formGroup.get("password")}get confirmPassword(){return this.formGroup.get("confirmPassword")}get mobile(){return this.formGroup.get("mobile")}get captcha(){return this.formGroup.get("captcha")}get otpCaptcha(){return this.formGroup.get("otpCaptcha")}ngOnInit(){this.getImageCaptcha(),this.policyMessage=[],this.forgotPasswordService.passwordpolicy().subscribe(e=>{0==e.code&&(this.policy=e.data,this.policyMessage=e.data.policMessageList)})}getImageCaptcha(){this.imageCaptchaService.captcha({}).subscribe(e=>{this.imageCaptcha=e.data.image,this.state=e.data.state,this.cdr.detectChanges()})}sendOtpCode(){return"mobile"==this.forgotType&&this.mobile.invalid?(this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0})):"email"==this.forgotType&&this.email.invalid?(this.email.markAsDirty({onlySelf:!0}),void this.email.updateValueAndValidity({onlySelf:!0})):void("mobile"==this.forgotType?this.forgotPasswordService.produceOtp({mobile:this.mobile.value,state:this.state,captcha:this.captcha.value}).subscribe(e=>103==e.code?(this.msg.error(this.i18n.fanyi("validation.forgot.captcha.error")),this.getImageCaptcha(),void this.cdr.detectChanges()):0!=e.code?(this.msg.error(this.i18n.fanyi("mxk.alert.operate.error")),this.getImageCaptcha(),void this.cdr.detectChanges()):(this.userId=e.data.userId,this.username=e.data.username,this.count=59,void(this.interval$=setInterval(()=>{this.count-=1,this.count<=0&&clearInterval(this.interval$),this.cdr.detectChanges()},1e3)))):"email"==this.forgotType&&this.forgotPasswordService.produceEmailOtp({email:this.email.value,state:this.state,captcha:this.captcha.value}).subscribe(e=>103==e.code?(this.msg.error(this.i18n.fanyi("validation.forgot.captcha.error")),this.getImageCaptcha(),void this.cdr.detectChanges()):0!=e.code?(this.msg.error(this.i18n.fanyi("mxk.alert.operate.error")),this.getImageCaptcha(),void this.cdr.detectChanges()):(this.userId=e.data.userId,this.username=e.data.username,this.count=59,void(this.interval$=setInterval(()=>{this.count-=1,this.count<=0&&clearInterval(this.interval$),this.cdr.detectChanges()},1e3)))))}onNextReset(e){return"mobile"==this.forgotType&&this.mobile.invalid?(this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0})):"email"==this.forgotType&&this.email.invalid?(this.email.markAsDirty({onlySelf:!0}),void this.email.updateValueAndValidity({onlySelf:!0})):this.captcha.invalid?(this.captcha.markAsDirty({onlySelf:!0}),void this.captcha.updateValueAndValidity({onlySelf:!0})):this.otpCaptcha.invalid?(this.otpCaptcha.markAsDirty({onlySelf:!0}),void this.otpCaptcha.updateValueAndValidity({onlySelf:!0})):void this.forgotPasswordService.validateCaptcha({userId:this.userId,state:this.state,captcha:this.captcha.value,otpCaptcha:this.otpCaptcha.value}).subscribe(i=>{if(0!==i.code)return this.msg.error(this.i18n.fanyi("app.login.message-invalid-verification-code")),void this.cdr.detectChanges();this.step=1})}onSubmit(e){return this.password.invalid?(this.password.markAsDirty({onlySelf:!0}),void this.password.updateValueAndValidity({onlySelf:!0})):this.confirmPassword.invalid?(this.confirmPassword.markAsDirty({onlySelf:!0}),void this.confirmPassword.updateValueAndValidity({onlySelf:!0})):void(""==this.dynamicallyCheckPasswordErrorMsg&&this.forgotPasswordService.setPassWord({forgotType:this.forgotType,userId:this.userId,username:this.username,password:this.password.value,confirmPassword:this.confirmPassword.value,otpCaptcha:this.otpCaptcha.value,state:this.state}).subscribe(i=>{if(0!==i.code)return this.msg.error(this.i18n.fanyi("mxk.alert.operate.error")),this.getImageCaptcha(),this.step=1,void this.cdr.detectChanges();this.msg.success(this.i18n.fanyi("mxk.alert.operate.success")),setTimeout(()=>{this.router.navigateByUrl("/")},3e3)}))}ngModelChange(){"email"==this.forgotType&&this.mobile.reset(),"mobile"==this.forgotType&&this.email.reset()}dynamicallyCheckConfirm(e){this.dynamicallyCheckPasswordErrorMsg=e!=this.form.model.password?this.i18n.fanyi("validation.password.twice"):""}dynamicallyCheckPassword(e){if(""==e)return void(this.dynamicallyCheckPasswordErrorMsg="");let i=this.policy;if(0!=i.minLength&&0!=i.maxLength){let a=e.length;if(a<i.minLength||a>i.maxLength)return void(this.dynamicallyCheckPasswordErrorMsg=this.i18n.fanyi("validation.password.non-conformance-strength"))}if(i.lowerCase>0){let a=Array.from(e),c=[];if(a.forEach(function(p,g,v){let x=p.charCodeAt();x>="a".charCodeAt(0)&&x<="z".charCodeAt(0)&&c.push(p)}),c.length<i.lowerCase)return void(this.dynamicallyCheckPasswordErrorMsg=this.i18n.fanyi("validation.password.non-conformance-strength"))}if(i.upperCase>0){let a=Array.from(e),c=[];if(a.forEach(function(p,g,v){let x=p.charCodeAt();x>="A".charCodeAt(0)&&x<="Z".charCodeAt(0)&&c.push(p)}),c.length<i.upperCase)return void(this.dynamicallyCheckPasswordErrorMsg=this.i18n.fanyi("validation.password.non-conformance-strength"))}if(i.digits>0){let a=Array.from(e),c=[];if(a.forEach(function(p,g,v){/^[0-9]+.?[0-9]*/.test(p)&&c.push(p)}),c.length<i.digits)return void(this.dynamicallyCheckPasswordErrorMsg=this.i18n.fanyi("validation.password.non-conformance-strength"))}if(i.specialChar>0){var r=new Array("\u2019","\u201d","!","@","#","$","%","^","&","*",".");let a=Array.from(e),c=[];if(a.forEach(function(p,g,v){-1!=r.indexOf(p)&&c.push(p)}),c.length<i.specialChar)return void(this.dynamicallyCheckPasswordErrorMsg=this.i18n.fanyi("validation.password.non-conformance-strength"))}this.dynamicallyCheckPasswordErrorMsg=""}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(u.F0),t.Y36(Xt),t.Y36(B),t.Y36(A.dD),t.Y36(m.Oi),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-forgot"]],decls:13,vars:14,consts:[["nz-form","","role","form",3,"formGroup"],[2,"width","100%"],["nzType","navigation",2,"width","100%",3,"nzCurrent"],["nzDescription","",3,"nzTitle"],["style","width: 100%",4,"ngIf"],["style","width: 400px;\n    position: absolute;\n    right: 50px;",4,"ngIf"],["nzSize","large","nzButtonStyle","solid",2,"margin-bottom","8px","width","100%",3,"ngModel","ngModelOptions","ngModelChange"],["nz-radio-button","",2,"width","50%",3,"nzValue"],["nzErrorTip",""],["nzSearch","","nzSize","large","nzPrefixIcon","lock","nzSearch","",3,"nzAddOnAfter"],["type","text","formControlName","captcha","nz-input","",3,"placeholder"],["suffixImageCaptchaButton",""],[3,"nzErrorTip"],["nzSize","large","nzPrefixIcon","mail","nzSearch","",3,"nzAddOnAfter"],["nz-input","","formControlName","otpCaptcha",3,"placeholder"],["suffixSendOtpCodeButton",""],["nz-button","","nzType","primary","nzSize","large",1,"submit",3,"click"],["routerLink","/passport/login",1,"login"],["nzSize","large","nzPrefixIcon","mail"],["nz-input","","formControlName","email",3,"placeholder"],["nzSize","large","nzPrefixIcon","mobile"],["nz-input","","formControlName","mobile",3,"placeholder"],["mobileErrorTip",""],[4,"ngIf"],[3,"src","click"],["type","button","nz-button","","nzSize","large","nzBlock","",3,"disabled","nzLoading","click"],[2,"width","400px","position","absolute","right","50px"],["nz-icon","","nzType","lock","nzTheme","outline"],[2,"padding","0 20px"],[4,"ngFor","ngForOf"],["nzRequired","","nzFor","password"],["nzSize","large",2,"width","100%",3,"nzSuffix"],["nz-input","","formControlName","password","id","password",3,"type","placeholder","ngModel","ngModelChange","input"],["suffixPasswordTemplate",""],["nzType","warning","nzShowIcon","",3,"nzMessage",4,"ngIf"],["nzRequired","","nzFor","confirmPassword"],["nz-input","","type","password","nzSize","large","formControlName","confirmPassword","name","confirmPassword","id","confirmPassword",3,"placeholder","ngModel","ngModelChange","input"],["nz-icon","",3,"nzType","click"],["nzType","warning","nzShowIcon","",3,"nzMessage"]],template:function(e,i){1&e&&(t.TgZ(0,"h3"),t._uU(1),t.ALo(2,"i18n"),t.qZA(),t.TgZ(3,"form",0)(4,"nz-form-item",1)(5,"nz-steps",2),t._UZ(6,"nz-step",3),t.ALo(7,"i18n"),t._UZ(8,"nz-step",3),t.ALo(9,"i18n"),t.qZA()(),t.YNc(10,ae,33,30,"nz-form-item",4),t.YNc(11,ce,7,4,"nz-form-item",5),t.YNc(12,me,30,29,"nz-form-item",4),t.qZA()),2&e&&(t.xp6(1),t.Oqu(t.lcZ(2,8,"mxk.forgot.forgot")),t.xp6(2),t.Q6J("formGroup",i.formGroup),t.xp6(2),t.Q6J("nzCurrent",i.step),t.xp6(1),t.s9C("nzTitle",t.lcZ(7,10,"mxk.forgot.step1")),t.xp6(2),t.s9C("nzTitle",t.lcZ(9,12,"mxk.forgot.step2")),t.xp6(2),t.Q6J("ngIf",0===i.step),t.xp6(1),t.Q6J("ngIf",1===i.step),t.xp6(1),t.Q6J("ngIf",1===i.step))},directives:[s._Y,s.JL,d.Lr,s.sg,_.SK,d.Nx,bt,Q,h.O5,S.Dg,s.JJ,s.On,S.Of,S.Bq,_.t3,d.Fd,C.w,f.gB,f.Zp,s.Fj,s.u,y.ix,b.dQ,u.yS,P.Ls,h.sg,d.iK,f.ke,O.r],pipes:[m.Ck],styles:["[_nghost-%COMP%]{display:block;width:460px;margin:0 auto}[_nghost-%COMP%]     .ant-tabs .ant-tabs-bar{margin-bottom:24px;text-align:center;border-bottom:0}[_nghost-%COMP%]   .login[_ngcontent-%COMP%]{float:right;line-height:40px}"]}),n})(),he=(()=>{class n{constructor(e,i,r,a,c){this.authnService=e,this.reuseTabService=i,this.router=r,this.settingsSrv=a,this.route=c,this.jwt=""}ngOnInit(){this.jwt=this.route.snapshot.queryParams.jwt,this.authnService.jwtAuth({jwt:this.jwt}).subscribe(e=>{0!==e.code?this.router.navigateByUrl("/passport/login"):(this.reuseTabService.clear(),this.authnService.auth(e.data),this.authnService.navigate({}))})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(w.p),t.Y36(Z.Wu),t.Y36(u.F0),t.Y36(m.gb),t.Y36(u.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-jwt-auth"]],decls:0,vars:0,template:function(e,i){},encapsulation:2}),n})(),ge=(()=>{class n{constructor(e,i,r,a,c,p){this.router=e,this.settingsService=i,this.authnService=r,this.tokenService=a,this.reuseTabService=c,this.route=p,this.redirect_uri=""}ngOnInit(){this.redirect_uri=this.route.snapshot.params[z.z.REDIRECT_URI],(null==this.redirect_uri||""==this.redirect_uri)&&(this.redirect_uri=this.route.snapshot.queryParams[z.z.REDIRECT_URI]),this.authnService.logout().pipe((0,T.x)(()=>{this.tokenService.clear(),null==this.redirect_uri||""==this.redirect_uri?this.router.navigateByUrl(this.tokenService.login_url):this.redirect_uri.startsWith("http")?location.href=this.redirect_uri:this.router.navigateByUrl(this.redirect_uri)})).subscribe(e=>{console.log(`Logout Response ${e.data}`)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.F0),t.Y36(m.gb),t.Y36(w.p),t.Y36(E.T),t.Y36(Z.Wu,8),t.Y36(u.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-logout"]],decls:0,vars:0,template:function(e,i){},encapsulation:2}),n})();var fe=l(9486);function _e(n,o){if(1&n&&(t.TgZ(0,"div",3),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,"app.register-result.msg",e.params)," ")}}let $=(()=>{class n{constructor(e,i){this.msg=i,this.params={email:""},this.email="",this.params.email=this.email=e.snapshot.queryParams.email||"maxkeysupport@maxkey.top"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(u.gz),t.Y36(A.dD))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-register-result"]],decls:7,vars:7,consts:[["type","success",3,"title","description"],["title",""],["routerLink","/","nz-button","","nzSize","large"],[1,"title",2,"font-size","20px"]],template:function(e,i){if(1&e&&(t.TgZ(0,"result",0),t.ALo(1,"i18n"),t.YNc(2,_e,3,4,"ng-template",null,1,t.W1O),t.TgZ(4,"button",2),t._uU(5),t.ALo(6,"i18n"),t.qZA()()),2&e){const r=t.MAs(3);t.s9C("description",t.lcZ(1,3,"app.register-result.activation-email")),t.Q6J("title",r),t.xp6(5),t.hij(" ",t.lcZ(6,5,"app.register-result.back-home")," ")}},directives:[fe.N,y.ix,b.dQ,u.rH,C.w],pipes:[m.Ck],encapsulation:2}),n})();function ze(n,o){return e=>{const i=e.get(n),r=e.get(o);return r.errors&&!r.errors.matchControl||r.setErrors(i.value!==r.value?{matchControl:!0}:null),null}}let ve=(()=>{class n{constructor(e){this.http=e}produceOtp(e){return this.http.get("/signup/produceOtp?_allow_anonymous=true",e)}register(e){return this.http.get("/signup/register?_allow_anonymous=true",e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(m.lP))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var xe=l(3610),G=l(8054);function Ce(n,o){if(1&n&&t._UZ(0,"nz-alert",25),2&n){const e=t.oxw();t.Q6J("nzType","error")("nzMessage",e.error)("nzShowIcon",!0)}}function ye(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.email.wrong-format")))}function be(n,o){if(1&n&&t.YNc(0,ye,3,3,"ng-container",26),2&n){const e=o.$implicit;t.Q6J("ngIf",null==e.errors?null:e.errors.email)}}function Te(n,o){1&n&&(t.TgZ(0,"div",34),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.strength.strong")))}function Se(n,o){1&n&&(t.TgZ(0,"div",35),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.strength.medium")))}function Ze(n,o){1&n&&(t.TgZ(0,"div",36),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.strength.short")))}function we(n,o){if(1&n&&(t.TgZ(0,"div",27),t.ynx(1,28),t.YNc(2,Te,3,3,"div",29),t.YNc(3,Se,3,3,"div",30),t.YNc(4,Ze,3,3,"div",31),t.BQk(),t.TgZ(5,"div"),t._UZ(6,"nz-progress",32),t.qZA(),t.TgZ(7,"p",33),t._uU(8),t.ALo(9,"i18n"),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngSwitch",e.status),t.xp6(1),t.Q6J("ngSwitchCase","ok"),t.xp6(1),t.Q6J("ngSwitchCase","pass"),t.xp6(2),t.Gre("progress-",e.status,""),t.xp6(1),t.Q6J("nzPercent",e.progress)("nzStatus",e.passwordProgressMap[e.status])("nzStrokeWidth",6)("nzShowInfo",!1),t.xp6(2),t.Oqu(t.lcZ(9,11,"validation.password.strength.msg"))}}function Ae(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.twice")))}function ke(n,o){if(1&n&&t.YNc(0,Ae,3,3,"ng-container",26),2&n){const e=o.$implicit;t.Q6J("ngIf",null==e.errors?null:e.errors.matchControl)}}function Ie(n,o){1&n&&(t.TgZ(0,"nz-select",37),t._UZ(1,"nz-option",38)(2,"nz-option",38),t.qZA()),2&n&&(t.xp6(1),t.Q6J("nzLabel","+86")("nzValue","+86"),t.xp6(1),t.Q6J("nzLabel","+87")("nzValue","+87"))}function Pe(n,o){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.phone-number.wrong-format")))}function Ue(n,o){if(1&n&&t.YNc(0,Pe,3,3,"ng-container",26),2&n){const e=o.$implicit;t.Q6J("ngIf",null==e.errors?null:e.errors.pattern)}}const Le=function(){return{"width.px":240}};const Ne=[{path:"passport",component:Wt.W,children:[{path:"login",component:V,data:{title:"\u767b\u5f55",titleI18n:"app.login.login"}},{path:"register",component:(()=>{class n{constructor(e,i,r,a,c,p){this.signUpService=i,this.msg=r,this.router=a,this.http=c,this.cdr=p,this.error="",this.type=0,this.loading=!1,this.captchaLoading=!1,this.visible=!1,this.status="pool",this.progress=0,this.passwordProgressMap={ok:"success",pass:"normal",pool:"exception"},this.count=0,this.form=e.group({username:[null,[s.kI.required]],displayName:[null,[s.kI.required]],email:[null,[s.kI.required,s.kI.email]],password:[null,[s.kI.required,s.kI.minLength(6),n.checkPassword.bind(this)]],confirm:[null,[s.kI.required,s.kI.minLength(6)]],mobilePrefix:["+86"],mobile:[null,[s.kI.required,s.kI.pattern(/^1\d{10}$/)]],captcha:[null,[s.kI.required]]},{validators:ze("password","confirm")})}get username(){return this.form.get("username")}get displayName(){return this.form.get("displayName")}get email(){return this.form.get("email")}get password(){return this.form.get("password")}get confirm(){return this.form.get("confirm")}get mobile(){return this.form.get("mobile")}get captcha(){return this.form.get("captcha")}static checkPassword(e){if(!e)return null;const i=this;i.visible=!!e.value,i.status=e.value&&e.value.length>9?"ok":e.value&&e.value.length>5?"pass":"pool",i.visible&&(i.progress=10*e.value.length>100?100:10*e.value.length)}getCaptcha(){if(this.mobile.invalid)return this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0});this.captchaLoading=!0,this.signUpService.produceOtp({mobile:this.mobile.value}).pipe((0,T.x)(()=>{this.captchaLoading=!1,this.cdr.detectChanges()})).subscribe(e=>{0!==e.code&&(this.msg.success("\u77ed\u4fe1\u53d1\u9001\u5931\u8d25"),this.cdr.detectChanges()),this.msg.success("\u77ed\u4fe1\u53d1\u9001\u6210\u529f")}),this.count=59,this.cdr.detectChanges(),this.interval$=setInterval(()=>{this.count-=1,this.cdr.detectChanges(),this.count<=0&&clearInterval(this.interval$)},1e3)}submit(){if(this.error="",Object.keys(this.form.controls).forEach(i=>{this.form.controls[i].markAsDirty(),this.form.controls[i].updateValueAndValidity()}),this.form.invalid)return;const e=this.form.value;this.loading=!0,this.cdr.detectChanges(),this.signUpService.register(e).pipe((0,T.x)(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(i=>{if(0!==i.code)return this.msg.success("\u6ce8\u518c\u5931\u8d25"),void this.cdr.detectChanges();this.msg.success("\u6ce8\u518c\u6210\u529f"),this.router.navigate(["passport","register-result"],{queryParams:{email:e.mail}})})}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(ve),t.Y36(A.dD),t.Y36(u.F0),t.Y36(m.lP),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-register"]],decls:63,vars:49,consts:[["nz-form","","role","form",3,"formGroup","ngSubmit"],["class","mb-lg",3,"nzType","nzMessage","nzShowIcon",4,"ngIf"],[3,"nzErrorTip"],["nzSize","large","nzAddonBeforeIcon","user"],["nz-input","","formControlName","username",3,"placeholder"],["nz-input","","formControlName","displayName",3,"placeholder"],["nz-input","","formControlName","email",3,"placeholder"],["mailErrorTip",""],["nzSize","large","nzAddonBeforeIcon","lock","nz-popover","","nzPopoverPlacement","right","nzPopoverTrigger","focus","nzPopoverOverlayClassName","register-password-cdk",3,"nzPopoverVisible","nzPopoverOverlayStyle","nzPopoverContent","nzPopoverVisibleChange"],["nz-input","","type","password","formControlName","password",3,"placeholder"],["pwdCdkTpl",""],["nzSize","large","nzAddonBeforeIcon","lock"],["nz-input","","type","password","formControlName","confirm",3,"placeholder"],["confirmErrorTip",""],["nzSize","large",3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","mobile","nz-input","",3,"placeholder"],["mobileErrorTip",""],[3,"nzGutter"],[3,"nzSpan"],["nzSize","large","nzAddonBeforeIcon","mail"],["nz-input","","formControlName","captcha",3,"placeholder"],["type","button","nz-button","","nzSize","large","nzBlock","",3,"disabled","nzLoading","click"],["nz-button","","nzType","primary","nzSize","large","type","submit",1,"submit",3,"nzLoading"],["routerLink","/passport/login",1,"login"],[1,"mb-lg",3,"nzType","nzMessage","nzShowIcon"],[4,"ngIf"],[2,"padding","4px 0"],[3,"ngSwitch"],["class","success",4,"ngSwitchCase"],["class","warning",4,"ngSwitchCase"],["class","error",4,"ngSwitchDefault"],[3,"nzPercent","nzStatus","nzStrokeWidth","nzShowInfo"],[1,"mt-sm"],[1,"success"],[1,"warning"],[1,"error"],["formControlName","mobilePrefix",2,"width","100px"],[3,"nzLabel","nzValue"]],template:function(e,i){if(1&e&&(t.TgZ(0,"h3"),t._uU(1),t.ALo(2,"i18n"),t.qZA(),t.TgZ(3,"form",0),t.NdJ("ngSubmit",function(){return i.submit()}),t.YNc(4,Ce,1,3,"nz-alert",1),t.TgZ(5,"nz-form-item")(6,"nz-form-control",2)(7,"nz-input-group",3),t._UZ(8,"input",4),t.ALo(9,"i18n"),t.qZA()()(),t.TgZ(10,"nz-form-item")(11,"nz-form-control",2)(12,"nz-input-group",3),t._UZ(13,"input",5),t.ALo(14,"i18n"),t.qZA()()(),t.TgZ(15,"nz-form-item")(16,"nz-form-control",2)(17,"nz-input-group",3),t._UZ(18,"input",6),t.ALo(19,"i18n"),t.qZA(),t.YNc(20,be,1,1,"ng-template",null,7,t.W1O),t.qZA()(),t.TgZ(22,"nz-form-item")(23,"nz-form-control",2)(24,"nz-input-group",8),t.NdJ("nzPopoverVisibleChange",function(a){return i.visible=a}),t._UZ(25,"input",9),t.ALo(26,"i18n"),t.qZA(),t.YNc(27,we,10,13,"ng-template",null,10,t.W1O),t.qZA()(),t.TgZ(29,"nz-form-item")(30,"nz-form-control",2)(31,"nz-input-group",11),t._UZ(32,"input",12),t.ALo(33,"i18n"),t.qZA(),t.YNc(34,ke,1,1,"ng-template",null,13,t.W1O),t.qZA()(),t.TgZ(36,"nz-form-item")(37,"nz-form-control",2)(38,"nz-input-group",14),t.YNc(39,Ie,3,4,"ng-template",null,15,t.W1O),t._UZ(41,"input",16),t.ALo(42,"i18n"),t.qZA(),t.YNc(43,Ue,1,1,"ng-template",null,17,t.W1O),t.qZA()(),t.TgZ(45,"nz-form-item")(46,"nz-form-control",2)(47,"nz-row",18)(48,"nz-col",19)(49,"nz-input-group",20),t._UZ(50,"input",21),t.ALo(51,"i18n"),t.qZA()(),t.TgZ(52,"nz-col",19)(53,"button",22),t.NdJ("click",function(){return i.getCaptcha()}),t._uU(54),t.ALo(55,"i18n"),t.qZA()()()()(),t.TgZ(56,"nz-form-item")(57,"button",23),t._uU(58),t.ALo(59,"i18n"),t.qZA(),t.TgZ(60,"a",24),t._uU(61),t.ALo(62,"i18n"),t.qZA()()()),2&e){const r=t.MAs(21),a=t.MAs(28),c=t.MAs(35),p=t.MAs(40),g=t.MAs(44);t.xp6(1),t.Oqu(t.lcZ(2,26,"app.register.register")),t.xp6(2),t.Q6J("formGroup",i.form),t.xp6(1),t.Q6J("ngIf",i.error),t.xp6(4),t.s9C("placeholder",t.lcZ(9,28,"mxk.users.username")),t.xp6(5),t.s9C("placeholder",t.lcZ(14,30,"mxk.users.displayName")),t.xp6(3),t.Q6J("nzErrorTip",r),t.xp6(2),t.s9C("placeholder",t.lcZ(19,32,"mxk.users.email")),t.xp6(6),t.Q6J("nzPopoverVisible",i.visible)("nzPopoverOverlayStyle",t.DdM(48,Le))("nzPopoverContent",a),t.xp6(1),t.s9C("placeholder",t.lcZ(26,34,"mxk.password.password")),t.xp6(5),t.Q6J("nzErrorTip",c),t.xp6(2),t.s9C("placeholder",t.lcZ(33,36,"mxk.password.confirmPassword")),t.xp6(5),t.Q6J("nzErrorTip",g),t.xp6(1),t.Q6J("nzAddOnBefore",p),t.xp6(3),t.s9C("placeholder",t.lcZ(42,38,"mxk.users.mobile")),t.xp6(6),t.Q6J("nzGutter",8),t.xp6(1),t.Q6J("nzSpan",16),t.xp6(2),t.s9C("placeholder",t.lcZ(51,40,"mxk.password.captcha")),t.xp6(2),t.Q6J("nzSpan",8),t.xp6(1),t.Q6J("disabled",i.count>0)("nzLoading",i.captchaLoading),t.xp6(1),t.hij(" ",i.count?i.count+"s":t.lcZ(55,42,"app.register.get-verification-code")," "),t.xp6(3),t.Q6J("nzLoading",i.loading),t.xp6(1),t.hij(" ",t.lcZ(59,44,"app.register.register")," "),t.xp6(3),t.Oqu(t.lcZ(62,46,"app.register.sign-in"))}},directives:[s._Y,s.JL,d.Lr,s.sg,h.O5,O.r,_.SK,d.Nx,_.t3,d.Fd,C.w,f.gB,f.Zp,s.Fj,s.JJ,s.u,xe.lU,h.RF,h.n9,h.ED,L.M,G.Vq,G.Ip,y.ix,b.dQ,u.yS],pipes:[m.Ck],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     h3{margin-bottom:20px;font-size:16px}[_nghost-%COMP%]     .submit{width:50%}[_nghost-%COMP%]     .login{float:right;line-height:40px}  .register-password-cdk .success,   .register-password-cdk .warning,   .register-password-cdk .error{transition:color .3s}  .register-password-cdk .success{color:#52c41a}  .register-password-cdk .warning{color:#faad14}  .register-password-cdk .error{color:#ff4d4f}  .register-password-cdk .progress-pass>.progress .ant-progress-bg{background-color:#faad14}"],changeDetection:0}),n})(),data:{title:"\u6ce8\u518c",titleI18n:"app.register.register"}},{path:"register-result",component:$,data:{title:"\u6ce8\u518c\u7ed3\u679c",titleI18n:"app.register.register"}},{path:"forgot",component:de,data:{title:"\u5fd8\u8bb0\u5bc6\u7801",titleI18n:"app.forgot.forgot"}},{path:"lock",component:R,data:{title:"\u9501\u5c4f",titleI18n:"app.lock"}}]},{path:"passport/callback/:provider",component:D},{path:"passport/jwt/auth",component:he},{path:"passport/logout",component:ge}];let Oe=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[u.Bz.forChild(Ne)],u.Bz]}),n})(),Me=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[W.m8,Oe,Tt]]}),n})()}}]);
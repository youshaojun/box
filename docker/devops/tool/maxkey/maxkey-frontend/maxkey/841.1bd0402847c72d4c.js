"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[841],{3841:(I,m,s)=>{s.r(m),s.d(m,{AccessModule:()=>F});var h=s(9808),p=s(4521),g=s(7629),C=s(647),z=s(5617),T=s(5650),y=s(7910),e=s(5e3),l=s(2382),k=s(822),x=s(520);let S=(()=>{class r extends k.b{constructor(t){super(t,"/access/session"),this._httpClient=t,this.server.urls.delete="/terminate"}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(x.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var b=s(9727),A=s(7484),u=s(4546),f=s(1894),v=s(2905),O=s(6042),D=s(2643),L=s(2683),i=s(592);function M(r,d){if(1&r){const t=e.EpF();e.TgZ(0,"tr")(1,"td",19),e.NdJ("nzCheckedChange",function(o){const c=e.CHM(t).$implicit;return e.oxw().onTableItemChecked(c.sessionId,o)}),e.qZA(),e.TgZ(2,"td",20)(3,"span"),e._uU(4),e.qZA()(),e.TgZ(5,"td",20),e._uU(6),e.qZA(),e.TgZ(7,"td",20),e._uU(8),e.qZA(),e.TgZ(9,"td",20),e._uU(10),e.qZA(),e.TgZ(11,"td",20),e._uU(12),e.qZA(),e.TgZ(13,"td",20),e._uU(14),e.qZA(),e.TgZ(15,"td",20),e._uU(16),e.qZA()()}if(2&r){const t=d.$implicit,n=e.oxw();e.xp6(1),e.Q6J("nzChecked",n.query.tableCheckedId.has(t.sessionId))("nzDisabled",t.disabled),e.xp6(3),e.Oqu(t.sessionId),e.xp6(2),e.Oqu(t.username),e.xp6(2),e.Oqu(t.displayName),e.xp6(2),e.Oqu(t.sourceIp),e.xp6(2),e.Oqu(t.browser),e.xp6(2),e.Oqu(t.platform),e.xp6(2),e.Oqu(t.loginTime)}}s(7758);const P=function(){return{xs:8,sm:8,md:8,lg:24,xl:48,xxl:48}},q=function(){return{standalone:!0}};const J=[{path:"sessions",component:(()=>{class r{constructor(t,n,o,a,c){this.fb=t,this.sessionsService=n,this.msg=o,this.i18n=a,this.cdr=c,this.query={params:{username:"",displayName:"",employeeNumber:"",startDate:"",endDate:"",startDatePicker:(0,T.Z)(new Date,-30),endDatePicker:new Date,pageSize:10,pageNumber:1,pageSizeOptions:[10,20,50]},results:{records:0,rows:[]},expandForm:!1,submitLoading:!1,tableLoading:!1,tableCheckedId:new Set,indeterminate:!1,checked:!1}}ngOnInit(){this.fetch()}onQueryParamsChange(t){this.query.params.pageNumber=t.pageIndex,this.query.params.pageSize=t.pageSize,this.fetch()}onSearch(){this.fetch()}onReset(){}onTerminate(t){t.preventDefault(),this.sessionsService.delete((0,g.$$)(this.query.tableCheckedId)).subscribe(n=>{0==n.code?(this.msg.success(this.i18n.fanyi("mxk.alert.operate.success")),this.fetch()):this.msg.error(this.i18n.fanyi("mxk.alert.operate.error")),this.cdr.detectChanges()})}fetch(){this.query.submitLoading=!0,this.query.tableLoading=!0,this.query.indeterminate=!1,this.query.checked=!1,this.query.tableCheckedId.clear(),this.query.expandForm?(this.query.params.endDate=(0,y.Z)(this.query.params.endDatePicker,"yyyy-MM-dd HH:mm:ss"),this.query.params.startDate=(0,y.Z)(this.query.params.startDatePicker,"yyyy-MM-dd HH:mm:ss")):(this.query.params.endDate="",this.query.params.startDate=""),this.sessionsService.fetch(this.query.params).subscribe(t=>{this.query.results=t.data,this.query.submitLoading=!1,this.query.tableLoading=!1,this.cdr.detectChanges()})}updateTableCheckedSet(t,n){n?this.query.tableCheckedId.add(t):this.query.tableCheckedId.delete(t)}refreshTableCheckedStatus(){const t=this.query.results.rows.filter(({disabled:n})=>!n);this.query.checked=t.every(({id:n})=>this.query.tableCheckedId.has(n)),this.query.indeterminate=t.some(({id:n})=>this.query.tableCheckedId.has(n))&&!this.query.checked}onTableItemChecked(t,n){this.updateTableCheckedSet(t,n),this.refreshTableCheckedStatus()}onTableAllChecked(t){this.query.results.rows.filter(({disabled:n})=>!n).forEach(({id:n})=>this.updateTableCheckedSet(n,t)),this.refreshTableCheckedStatus()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(l.qu),e.Y36(S),e.Y36(b.dD),e.Y36(z.Oi),e.Y36(e.sBO))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-sessions"]],decls:62,vars:70,consts:[[3,"nzBordered"],["nz-form","",1,"search__form",3,"nzLayout","ngSubmit"],["nz-row","",3,"nzGutter"],["nz-col","","nzMd","8","nzSm","24"],["nzFor","startDatePicker"],["nzShowTime","","nzFormat","yyyy-MM-dd HH:mm:ss","name","startDatePicker","nzPlaceHolder","startDatePicker",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","endDatePicker"],["nzShowTime","","nzFormat","yyyy-MM-dd HH:mm:ss","name","endDatePicker","nzPlaceHolder","endDatePicker",3,"ngModel","ngModelOptions","ngModelChange"],["nz-col","",3,"nzSpan"],["nz-button","","type","submit",3,"nzType","nzLoading"],["nz-button","","type","reset",1,"mx-sm",3,"click"],["nz-button","",1,"mx-sm","d-none",3,"click"],["nz-col","",1,"table-list-toolbar",3,"nzSpan"],["nz-button","","type","button","nzDanger","",1,"mx-sm",3,"nzType","click"],["nzTableLayout","auto","nzSize","small","nzShowSizeChanger","",3,"nzBordered","nzData","nzFrontPagination","nzTotal","nzPageSizeOptions","nzPageSize","nzPageIndex","nzLoading","nzQueryParams"],["dynamicTable",""],[3,"nzChecked","nzIndeterminate","nzCheckedChange"],["nzAlign","center"],[4,"ngFor","ngForOf"],[3,"nzChecked","nzDisabled","nzCheckedChange"],["nzAlign","left"]],template:function(t,n){1&t&&(e.TgZ(0,"nz-card",0)(1,"form",1),e.NdJ("ngSubmit",function(){return n.onSearch()}),e.TgZ(2,"div",2)(3,"div",3)(4,"nz-form-item")(5,"nz-form-label",4),e._uU(6),e.ALo(7,"i18n"),e.qZA(),e.TgZ(8,"nz-form-control")(9,"nz-date-picker",5),e.NdJ("ngModelChange",function(a){return n.query.params.startDatePicker=a}),e.qZA()()()(),e.TgZ(10,"div",3)(11,"nz-form-item")(12,"nz-form-label",6),e._uU(13),e.ALo(14,"i18n"),e.qZA(),e.TgZ(15,"nz-form-control")(16,"nz-date-picker",7),e.NdJ("ngModelChange",function(a){return n.query.params.endDatePicker=a}),e.qZA()()()(),e.TgZ(17,"div",8)(18,"button",9),e._uU(19),e.ALo(20,"i18n"),e.qZA(),e.TgZ(21,"button",10),e.NdJ("click",function(){return n.onReset()}),e._uU(22),e.ALo(23,"i18n"),e.qZA(),e.TgZ(24,"button",11),e.NdJ("click",function(){return n.query.expandForm=!n.query.expandForm}),e._uU(25),e.ALo(26,"i18n"),e.ALo(27,"i18n"),e.qZA()()()()(),e.TgZ(28,"nz-card")(29,"div",12)(30,"button",13),e.NdJ("click",function(a){return n.onTerminate(a)}),e._uU(31),e.ALo(32,"i18n"),e.qZA()(),e.TgZ(33,"div",8)(34,"nz-table",14,15),e.NdJ("nzQueryParams",function(a){return n.onQueryParamsChange(a)}),e.TgZ(36,"thead")(37,"tr")(38,"th",16),e.NdJ("nzCheckedChange",function(a){return n.onTableAllChecked(a)}),e.qZA(),e.TgZ(39,"th",17),e._uU(40),e.ALo(41,"i18n"),e.qZA(),e.TgZ(42,"th",17),e._uU(43),e.ALo(44,"i18n"),e.qZA(),e.TgZ(45,"th",17),e._uU(46),e.ALo(47,"i18n"),e.qZA(),e.TgZ(48,"th",17),e._uU(49),e.ALo(50,"i18n"),e.qZA(),e.TgZ(51,"th",17),e._uU(52),e.ALo(53,"i18n"),e.qZA(),e.TgZ(54,"th",17),e._uU(55),e.ALo(56,"i18n"),e.qZA(),e.TgZ(57,"th",17),e._uU(58),e.ALo(59,"i18n"),e.qZA()()(),e.TgZ(60,"tbody"),e.YNc(61,M,17,9,"tr",18),e.qZA()()()()),2&t&&(e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("nzLayout","inline"),e.xp6(1),e.Q6J("nzGutter",e.DdM(67,P)),e.xp6(4),e.Oqu(e.lcZ(7,39,"mxk.text.startDate")),e.xp6(3),e.Q6J("ngModel",n.query.params.startDatePicker)("ngModelOptions",e.DdM(68,q)),e.xp6(4),e.Oqu(e.lcZ(14,41,"mxk.text.endDate")),e.xp6(3),e.Q6J("ngModel",n.query.params.endDatePicker)("ngModelOptions",e.DdM(69,q)),e.xp6(1),e.ekj("text-right",n.query.expandForm),e.Q6J("nzSpan",n.query.expandForm?24:8),e.xp6(1),e.Q6J("nzType","primary")("nzLoading",n.query.submitLoading),e.xp6(1),e.Oqu(e.lcZ(20,43,"mxk.text.query")),e.xp6(3),e.Oqu(e.lcZ(23,45,"mxk.text.reset")),e.xp6(3),e.hij(" ",n.query.expandForm?e.lcZ(26,47,"mxk.text.collapse"):e.lcZ(27,49,"mxk.text.expand"),""),e.xp6(4),e.Q6J("nzSpan",24),e.xp6(1),e.Q6J("nzType","primary"),e.xp6(1),e.Oqu(e.lcZ(32,51,"mxk.text.terminate")),e.xp6(2),e.Q6J("nzSpan",24),e.xp6(1),e.Q6J("nzBordered",!0)("nzData",n.query.results.rows)("nzFrontPagination",!1)("nzTotal",n.query.results.records)("nzPageSizeOptions",n.query.params.pageSizeOptions)("nzPageSize",n.query.params.pageSize)("nzPageIndex",n.query.params.pageNumber)("nzLoading",n.query.tableLoading),e.xp6(4),e.Q6J("nzChecked",n.query.checked)("nzIndeterminate",n.query.indeterminate),e.xp6(2),e.Oqu(e.lcZ(41,53,"mxk.history.login.sessionId")),e.xp6(3),e.Oqu(e.lcZ(44,55,"mxk.history.login.username")),e.xp6(3),e.Oqu(e.lcZ(47,57,"mxk.history.login.displayName")),e.xp6(3),e.Oqu(e.lcZ(50,59,"mxk.history.login.sourceIp")),e.xp6(3),e.Oqu(e.lcZ(53,61,"mxk.history.login.browser")),e.xp6(3),e.Oqu(e.lcZ(56,63,"mxk.history.login.platform")),e.xp6(3),e.Oqu(e.lcZ(59,65,"mxk.history.login.loginTime")),e.xp6(3),e.Q6J("ngForOf",n.query.results.rows))},directives:[A.bd,l._Y,l.JL,l.F,u.Lr,f.SK,f.t3,u.Nx,u.iK,u.Fd,v.uw,l.JJ,l.On,O.ix,D.dQ,L.w,i.N8,i.Om,i.$Z,i.Uo,i._C,i.g6,i.UX,i.p0,h.sg,i.h7],pipes:[z.Ck],styles:[""]}),r})()}];let F=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[[C.PV,g.m8,h.ez,p.Bz.forChild(J)],p.Bz]}),r})()}}]);
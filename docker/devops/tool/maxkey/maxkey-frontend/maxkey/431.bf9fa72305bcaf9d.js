"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[431],{6431:(I,h,r)=>{r.r(h),r.d(h,{AuthzModule:()=>V});var x=r(9808),m=r(4521),b=r(7629),S=r(8226),u=r(2340),n=r(5e3);let J=(()=>{class e{constructor(){}ngOnInit(){let o="";o=u.N.api.baseUrl.endsWith("/")?u.N.api.baseUrl.substring(0,u.N.api.baseUrl.length-1):u.N.api.baseUrl,window.location.href=`${o}/authz/jwt/maxkey_mgt`}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-callback"]],decls:0,vars:0,template:function(o,t){},encapsulation:2}),e})();var s=r(2382),w=r(5723),O=r(4710),z=r(9727),v=r(7484),p=r(4546),M=r(1457),c=r(1894),g=r(1047),C=r(2683),y=r(647),Z=r(6042),T=r(2643),A=r(5617);function N(e,l){if(1&e){const o=n.EpF();n.TgZ(0,"i",29),n.NdJ("click",function(){n.CHM(o);const i=n.oxw();return i.passwordVisible=!i.passwordVisible}),n.qZA()}if(2&e){const o=n.oxw();n.Q6J("nzType",o.passwordVisible?"eye-invisible":"eye")}}function Q(e,l){if(1&e){const o=n.EpF();n.TgZ(0,"i",29),n.NdJ("click",function(){n.CHM(o);const i=n.oxw();return i.confirmPasswordVisible=!i.confirmPasswordVisible}),n.qZA()}if(2&e){const o=n.oxw();n.Q6J("nzType",o.confirmPasswordVisible?"eye-invisible":"eye")}}const d=function(){return{standalone:!0}};let _=(()=>{class e{constructor(o,t,i,a,f,D){this.router=t,this.route=i,this.accountsService=a,this.msg=f,this.cdr=D,this.form={submitting:!1,model:new w.X},this.redirect_uri="",this.formGroup=new s.cw({}),this.confirmPasswordVisible=!1,this.passwordVisible=!1}ngOnInit(){this.accountsService.get(this.route.snapshot.queryParams.appId).subscribe(o=>{console.log(o.data),this.form.model.init(o.data),this.cdr.detectChanges()}),this.redirect_uri=this.route.snapshot.queryParams.redirect_uri}onSubmit(){this.form.submitting=!0,this.form.model.trans(),this.accountsService.update(this.form.model).subscribe(o=>{0==o.code?(this.form.model.init(o.data),this.msg.success("\u63d0\u4ea4\u6210\u529f"),this.redirect_uri&&(window.location.href=`${u.N.api.baseUrl}${this.redirect_uri}`)):this.msg.success("\u63d0\u4ea4\u5931\u8d25")}),this.form.submitting=!1,this.cdr.detectChanges()}}return e.\u0275fac=function(o){return new(o||e)(n.Y36(s.qu),n.Y36(m.F0),n.Y36(m.gz),n.Y36(O.i),n.Y36(z.dD),n.Y36(n.sBO))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-credential"]],decls:52,vars:67,consts:[["nz-form","","se-container","1",3,"formGroup","ngSubmit"],["nz-row","",2,"width","100%"],["nz-col","","nzMd","6"],["nz-col","","nzMd","12"],[2,"display","none"],["nzFor","id",3,"nzMd"],["nzErrorTip","The input is not valid id!",3,"nzMd"],["nz-input","","name","id","id","id","value","id",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","displayName",3,"nzSm","nzXs"],["nzErrorTip","The input is not displayName!",3,"nzSm","nzXs","nzXl"],["nz-input","","disabled","true","name","displayName","id","displayName","value","0",3,"ngModel","ngModelOptions","ngModelChange"],["nzFor","username",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid username!",3,"nzSm","nzXs"],["nz-input","","disabled","true","name","username","id","username",3,"ngModel","ngModelOptions","ngModelChange"],["nzRequired","","nzFor","relatedUsername",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid relatedUsername!",3,"nzSm","nzXs"],["nz-input","","name","relatedUsername","id","relatedUsername",3,"ngModel","ngModelOptions","ngModelChange"],["nzRequired","","nzFor","relatedPassword",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid relatedPassword!",3,"nzSm","nzXs"],[2,"width","100%",3,"nzSuffix"],["nz-input","","placeholder","new password","name","relatedPassword","id","relatedPassword",3,"type","ngModel","ngModelOptions","ngModelChange"],["suffixPasswordTemplate",""],["nzRequired","","nzFor","confirmPassword",3,"nzSm","nzXs"],["nzErrorTip","The input is not valid confirmPassword!",3,"nzSm","nzXs"],["nz-input","","placeholder","confirm password","name","confirmPassword","id","confirmPassword",3,"type","ngModel","ngModelOptions","ngModelChange"],["suffixConfirmPasswordTemplate",""],[2,"width","100%"],[3,"nzOffset","nzSpan"],["nz-button","","nzType","primary","type","submit",3,"nzLoading"],["nz-icon","",3,"nzType","click"]],template:function(o,t){if(1&o&&(n.TgZ(0,"nz-card")(1,"form",0),n.NdJ("ngSubmit",function(){return t.onSubmit()}),n.TgZ(2,"div",1),n._UZ(3,"div",2),n.TgZ(4,"div",3)(5,"nz-form-item",4)(6,"nz-form-label",5),n._uU(7,"id"),n.qZA(),n.TgZ(8,"nz-form-control",6)(9,"input",7),n.NdJ("ngModelChange",function(a){return t.form.model.id=a}),n.qZA()()(),n.TgZ(10,"nz-form-item")(11,"nz-form-label",8),n._uU(12),n.ALo(13,"i18n"),n.qZA(),n.TgZ(14,"nz-form-control",9)(15,"input",10),n.NdJ("ngModelChange",function(a){return t.form.model.displayName=a}),n.qZA()()(),n.TgZ(16,"nz-form-item")(17,"nz-form-label",11),n._uU(18),n.ALo(19,"i18n"),n.qZA(),n.TgZ(20,"nz-form-control",12)(21,"input",13),n.NdJ("ngModelChange",function(a){return t.form.model.username=a}),n.qZA()()(),n.TgZ(22,"nz-form-item")(23,"nz-form-label",14),n._uU(24),n.ALo(25,"i18n"),n.qZA(),n.TgZ(26,"nz-form-control",15)(27,"input",16),n.NdJ("ngModelChange",function(a){return t.form.model.relatedUsername=a}),n.qZA()()(),n.TgZ(28,"nz-form-item")(29,"nz-form-label",17),n._uU(30),n.ALo(31,"i18n"),n.qZA(),n.TgZ(32,"nz-form-control",18)(33,"nz-input-group",19)(34,"input",20),n.NdJ("ngModelChange",function(a){return t.form.model.relatedPassword=a}),n.qZA()(),n.YNc(35,N,1,1,"ng-template",null,21,n.W1O),n.qZA()(),n.TgZ(37,"nz-form-item")(38,"nz-form-label",22),n._uU(39),n.ALo(40,"i18n"),n.qZA(),n.TgZ(41,"nz-form-control",23)(42,"nz-input-group",19)(43,"input",24),n.NdJ("ngModelChange",function(a){return t.form.model.confirmPassword=a}),n.qZA()(),n.YNc(44,Q,1,1,"ng-template",null,25,n.W1O),n.qZA()(),n.TgZ(46,"nz-form-item",26)(47,"nz-form-control",27)(48,"button",28),n._uU(49),n.ALo(50,"i18n"),n.qZA()()()()(),n._UZ(51,"div",2),n.qZA()()),2&o){const i=n.MAs(36),a=n.MAs(45);n.xp6(1),n.Q6J("formGroup",t.formGroup),n.xp6(5),n.Q6J("nzMd",6),n.xp6(2),n.Q6J("nzMd",18),n.xp6(1),n.Q6J("ngModel",t.form.model.id)("ngModelOptions",n.DdM(61,d)),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(1),n.Oqu(n.lcZ(13,49,"mxk.password.displayName")),n.xp6(2),n.Q6J("nzSm",14)("nzXs",36)("nzXl",48),n.xp6(1),n.Q6J("ngModel",t.form.model.displayName)("ngModelOptions",n.DdM(62,d)),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(1),n.Oqu(n.lcZ(19,51,"mxk.password.username")),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("ngModel",t.form.model.username)("ngModelOptions",n.DdM(63,d)),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(1),n.Oqu(n.lcZ(25,53,"mxk.accounts.relatedUsername")),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("ngModel",t.form.model.relatedUsername)("ngModelOptions",n.DdM(64,d)),n.xp6(2),n.Q6J("nzSm",6)("nzXs",24),n.xp6(1),n.Oqu(n.lcZ(31,55,"mxk.accounts.relatedPassword")),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("nzSuffix",i),n.xp6(1),n.Q6J("type",t.passwordVisible?"text":"password")("ngModel",t.form.model.relatedPassword)("ngModelOptions",n.DdM(65,d)),n.xp6(4),n.Q6J("nzSm",6)("nzXs",24),n.xp6(1),n.Oqu(n.lcZ(40,57,"mxk.password.confirmPassword")),n.xp6(2),n.Q6J("nzSm",14)("nzXs",24),n.xp6(1),n.Q6J("nzSuffix",a),n.xp6(1),n.Q6J("type",t.confirmPasswordVisible?"text":"password")("ngModel",t.form.model.confirmPassword)("ngModelOptions",n.DdM(66,d)),n.xp6(4),n.Q6J("nzOffset",10)("nzSpan",12),n.xp6(1),n.Q6J("nzLoading",t.form.submitting),n.xp6(1),n.Oqu(n.lcZ(50,59,"mxk.text.save"))}},directives:[v.bd,s._Y,s.JL,p.Lr,M.nV,s.sg,c.SK,c.t3,p.Nx,p.iK,p.Fd,g.Zp,s.Fj,s.JJ,s.On,C.w,g.gB,g.ke,y.Ls,Z.ix,T.dQ],pipes:[A.Ck],styles:[""]}),e})();var U=r(822),X=r(520);let P=(()=>{class e extends U.b{constructor(o){super(o,"/authz/oauth/v20/approval_confirm"),this._httpClient=o}approval(o){return this.http.post(`/authz/oauth/v20/authorize/approval?user_oauth_approval=${o.user_oauth_approval}`,o)}}return e.\u0275fac=function(o){return new(o||e)(n.LFG(X.eN))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var L=r(6114);const F=function(){return{standalone:!0}},Y=[{path:"authz",component:S.L,children:[{path:"credential",component:_,data:{title:"credential",titleI18n:"app.login.login"}},{path:"oauth2approve",component:(()=>{class e{constructor(o,t,i,a,f){this.oauth2ApproveService=o,this.router=t,this.route=i,this.msg=a,this.cdr=f,this.form={submitting:!1,model:{approval_prompt:"force"}},this.redirect_uri="",this.formGroup=new s.cw({})}ngOnInit(){this.oauth2ApproveService.get(this.route.snapshot.queryParams.oauth_approval).subscribe(o=>{console.log(o.data),this.form.model.clientId=o.data.clientId,this.form.model.appName=o.data.appName,this.form.model.iconBase64=o.data.iconBase64,this.form.model.oauth_version=o.data.oauth_version,this.form.model.user_oauth_approval="true",this.form.model.approval_prompt=o.data.approval_prompt,this.cdr.detectChanges(),"auto"==this.form.model.approval_prompt&&this.onSubmit()})}onSubmit(){this.form.submitting=!0,this.oauth2ApproveService.approval(this.form.model).subscribe(o=>{0==o.code?("force"==this.form.model.approval_prompt&&this.msg.success("\u63d0\u4ea4\u6210\u529f"),window.location.href=o.data):this.msg.success("\u63d0\u4ea4\u5931\u8d25")}),this.form.submitting=!1,this.cdr.detectChanges()}onDeny(){window.close()}}return e.\u0275fac=function(o){return new(o||e)(n.Y36(P),n.Y36(m.F0),n.Y36(m.gz),n.Y36(z.dD),n.Y36(n.sBO))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-oauth2-approve"]],decls:32,vars:27,consts:[["nz-form","","se-container","1",3,"formGroup","ngSubmit"],["nz-row","",2,"width","100%"],["nz-col","","nzMd","6"],["nz-col","","nzMd","12"],["nz-col","","nzMd","24",2,"text-align","center"],["nz-col","","nzMd","12",2,"text-align","right"],[2,"margin-right","50px","width","120px",3,"src"],[2,"width","100%"],["nz-checkbox","",3,"ngModel","ngModelOptions","ngModelChange"],[3,"nzOffset","nzSpan"],["nz-button","","nzType","primary","type","submit",3,"nzLoading"],["nz-button","","nzType","default","type","button",3,"click"]],template:function(o,t){1&o&&(n.TgZ(0,"nz-card")(1,"form",0),n.NdJ("ngSubmit",function(){return t.onSubmit()}),n.TgZ(2,"div",1),n._UZ(3,"div",2),n.TgZ(4,"div",3)(5,"nz-form-item")(6,"div",4)(7,"h2"),n._uU(8),n.ALo(9,"i18n"),n.qZA()()(),n.TgZ(10,"nz-form-item")(11,"div",5),n._UZ(12,"img",6),n.qZA(),n.TgZ(13,"div",3)(14,"nz-form-item",7),n._uU(15),n.qZA(),n.TgZ(16,"nz-form-item",7),n._uU(17),n.ALo(18,"i18n"),n.qZA(),n.TgZ(19,"nz-form-item",7)(20,"label",8),n.NdJ("ngModelChange",function(a){return t.form.model.user_oauth_approval=a}),n._uU(21),n.ALo(22,"i18n"),n.qZA()()()(),n.TgZ(23,"nz-form-item",7)(24,"nz-form-control",9)(25,"button",10),n._uU(26),n.ALo(27,"i18n"),n.qZA(),n.TgZ(28,"button",11),n.NdJ("click",function(){return t.onDeny()}),n._uU(29),n.ALo(30,"i18n"),n.qZA()()()()(),n._UZ(31,"div",2),n.qZA()()),2&o&&(n.Gre(" ","auto"==t.form.model.approval_prompt?"d-none":"",""),n.xp6(1),n.Q6J("formGroup",t.formGroup),n.xp6(7),n.Oqu(n.lcZ(9,16,"mxk.apps.oauth.approval.title")),n.xp6(4),n.s9C("src",t.form.model.iconBase64,n.LSH),n.xp6(3),n.hij(" ",t.form.model.appName," "),n.xp6(2),n.hij(" ",n.lcZ(18,18,"mxk.apps.oauth.approval.info")," "),n.xp6(3),n.Q6J("ngModel",t.form.model.user_oauth_approval)("ngModelOptions",n.DdM(26,F)),n.xp6(1),n.hij(" ",n.lcZ(22,20,"mxk.apps.oauth.approval.context")," "),n.xp6(3),n.Q6J("nzOffset",10)("nzSpan",12),n.xp6(1),n.Q6J("nzLoading",t.form.submitting),n.xp6(1),n.hij(" ",n.lcZ(27,22,"mxk.apps.oauth.approval.authorize")," "),n.xp6(3),n.hij(" ",n.lcZ(30,24,"mxk.apps.oauth.approval.deny")," "))},directives:[v.bd,s._Y,s.JL,p.Lr,M.nV,s.sg,c.SK,c.t3,p.Nx,L.Ie,s.JJ,s.On,p.Fd,Z.ix,T.dQ,C.w],pipes:[A.Ck],styles:[""]}),e})(),data:{title:"credential",titleI18n:"app.login.login"}},{path:"mgt",component:J,data:{title:"mgt",titleI18n:"app.login.login"}}]}];let V=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[[b.m8,x.ez,m.Bz.forChild(Y)],m.Bz]}),e})()}}]);